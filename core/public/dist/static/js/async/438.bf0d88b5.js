"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["438"],{2822:function(e,t,a){a.d(t,{Z:()=>o});var n=a(1452),l=a(2398);let o=function(e){return"number"==typeof e||(0,l.Z)(e)&&"[object Number]"==(0,n.Z)(e)}},7714:function(e,t,a){a.d(t,{Z:()=>f});var n=a(5083),l=a(209),o=a(1321),r=a(4124),i=a(2931),c=a(2249),s=a(6253),u=a(3876),d=a(8713);let p={name:"Flex",self:function(){return d.Z}},m=Object.assign(Object.assign({},o.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),f=(0,l.aZ)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:a}=(0,r.ZP)(e),s=(0,o.Z)("Flex","-flex",void 0,p,e,t);return{rtlEnabled:(0,i.V)("Flex",a,t),mergedClsPrefix:t,margin:(0,l.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,c.Tl)("gap",t)]:a}}=s.value,{row:l,col:o}=(0,n.yU)(a);return{horizontal:(0,n.fQ)(o),vertical:(0,n.fQ)(l)}})}},render(){let{vertical:e,reverse:t,align:a,inline:n,justify:o,margin:r,wrap:i,mergedClsPrefix:c,rtlEnabled:d}=this,p=(0,s.x)((0,u.z)(this),!1);return p.length?(0,l.h)("div",{role:"none",class:[`${c}-flex`,d&&`${c}-flex--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:o,flexWrap:!i||e?"nowrap":"wrap",alignItems:a,gap:`${r.vertical}px ${r.horizontal}px`}},p):null}})},1625:function(e,t,a){a.d(t,{WH:()=>r,hI:()=>o,iE:()=>s,mD:()=>c,sS:()=>i,vi:()=>u});var n=a(4203);let{t:l}=a(4958).Z.global,o=e=>n.e.get("/contact/group/list",{params:e}),r=()=>n.e.get("/contact/group/all"),i=e=>n.e.post("/contact/group/create",e,{fetchOptions:{loading:l("contacts.group.loading.createGroup"),successMessage:!0}}),c=e=>n.e.post("/contact/group/update",e,{fetchOptions:{loading:l("contacts.group.loading.updateGroup"),successMessage:!0}}),s=e=>n.e.post("/contact/group/delete",e,{fetchOptions:{loading:l("contacts.group.loading.deleteGroup"),successMessage:!0}}),u=e=>n.e.post("/contact/group/contact_count",e)},8406:function(e,t,a){a.r(t),a.d(t,{default:()=>j});var n=a(4652),l=a(6818),o=a(3435),r=a(2748),i=a(209),c=a(3447),s=a(7714),u=a(3312),d=a(6949),p=a(2965),m=a(1625),f=a(3951),g=a(6714),h=a(6883),v=a(8454),S=a(5822),_=a(5778);let U={class:"pt-12px"},w={class:"flex-1"},y={class:"mt-16px text-desc"},b={class:"mr-4px"},x={class:"mt-8px text-desc"},Z=(0,i.aZ)({__name:"GroupAdd",setup(e){let{t}=(0,_.QT)(),a=(0,i.AE)("formRef"),n=(0,i.qj)({create_type:2,name:"",file_data:"",file_type:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},o=e=>{let t=new FileReader;t.onload=t=>{var a;n.file_type=e.name.substring(e.name.lastIndexOf(".")+1),n.file_data=null===(a=t.target)||void 0===a?void 0:a.result},e.file&&t.readAsText(e.file)},r=async()=>{await (0,S.Sv)({file_path:"/opt/Billion-Mail/data/example_recipients.txt"})},[s,d]=(0,u.d)({onChangeState:e=>{e&&(n.name="")},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,m.sS)((0,i.IU)(n));let t=d.getState();null==t||t.refresh()}});return(e,u)=>{let d=v.Z,p=h.ZP,m=g.Z,S=c.ZP,_=f.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(s),{title:(0,i.SU)(t)("contacts.group.add.title"),width:"500"},{default:(0,i.w5)(()=>[(0,i._)("div",U,[(0,i.Wm)(_,{ref_key:"formRef",ref:a,model:(0,i.SU)(n),rules:l},{default:(0,i.w5)(()=>[(0,i.Wm)(p,{label:(0,i.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,i.w5)(()=>[(0,i.Wm)(d,{value:(0,i.SU)(n).name,"onUpdate:value":u[0]||(u[0]=e=>(0,i.SU)(n).name=e)},null,8,["value"])]),_:1},8,["label"]),(0,i.Wm)(p,{label:(0,i.SU)(t)("contacts.group.form.file"),path:"file_data"},{default:(0,i.w5)(()=>[(0,i._)("div",w,[(0,i.Wm)(m,{"is-upload":!1,accept:["txt"],onChange:o}),(0,i._)("div",y,[(0,i._)("span",b,(0,i.zw)((0,i.SU)(t)("contacts.group.fileUpload.hint")),1),(0,i.Wm)(S,{text:"",type:"primary",onClick:r},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)(e.$t("common.actions.download")),1)]),_:1})]),(0,i._)("div",x,(0,i.zw)((0,i.SU)(t)("contacts.group.fileUpload.emptyHint")),1)])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}}),W={class:"pt-12px"},k=(0,i.aZ)({__name:"GroupRename",setup(e){let{t}=(0,_.QT)(),a=(0,i.AE)("formRef"),n=(0,i.qj)({group_id:0,name:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},[o,r]=(0,u.d)({onChangeState:e=>{if(e){let{row:e}=r.getState();e&&(n.group_id=e.id,n.name=e.name)}else n.group_id=0,n.name=""},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,m.mD)((0,i.IU)(n));let t=r.getState();null==t||t.refresh()}});return(e,r)=>{let c=v.Z,s=h.ZP,u=f.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(o),{title:(0,i.SU)(t)("contacts.group.rename.title"),width:"400"},{default:(0,i.w5)(()=>[(0,i._)("div",W,[(0,i.Wm)(u,{ref_key:"formRef",ref:a,model:(0,i.SU)(n),rules:l},{default:(0,i.w5)(()=>[(0,i.Wm)(s,{label:(0,i.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,i.w5)(()=>[(0,i.Wm)(c,{value:(0,i.SU)(n).name,"onUpdate:value":r[0]||(r[0]=e=>(0,i.SU)(n).name=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var z=a(5e3);function C(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,i.lA)(e)}let j=(0,i.aZ)({__name:"index",setup(e){let{t}=(0,_.QT)(),a=(0,z.tv)(),{tableParams:f,tableList:g,loading:h,tableTotal:v,getTableData:S}=(0,d.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:m.hI}),U=(0,i.iH)([{key:"name",title:t("contacts.group.columns.name"),minWidth:120,render:e=>(0,i.Wm)(c.ZP,{text:!0,type:"primary",onClick:()=>{a.push({path:"/contacts/subscribers",state:{group_id:e.id}})}},{default:()=>[e.name]})},{key:"total_count",title:t("contacts.group.columns.subscribers"),minWidth:100,render:e=>e.total_count||0},{key:"unsubscribe_count",title:t("contacts.group.columns.unsubscribe"),minWidth:100,render:e=>e.unsubscribe_count||0},{key:"create_time",title:t("contacts.group.columns.createdAt"),minWidth:140,render:e=>(0,p.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let a,n;return(0,i.Wm)(s.Z,{inline:!0},{default:()=>[(0,i.Wm)(c.ZP,{type:"primary",text:!0,onClick:()=>{j(e)}},C(a=t("common.actions.rename"))?a:{default:()=>[a]}),(0,i.Wm)(c.ZP,{type:"error",text:!0,onClick:()=>{R(e)}},C(n=t("common.actions.delete"))?n:{default:()=>[n]})]})}}]),[w,y]=(0,u.d)({component:Z,state:{refresh:S}}),b=()=>{y.open()},[x,W]=(0,u.d)({component:k,state:{refresh:S}}),j=e=>{W.setState({row:e}),W.open()},R=e=>{(0,p.iG)({title:t("contacts.group.delete.title"),content:t("contacts.group.delete.confirm",{name:e.name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,m.iE)({group_ids:[e.id]}),S()}})};return(e,a)=>{let s=r.Z,u=o.Z,d=l.Z,p=n.Z;return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(p,null,{toolsLeft:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(c.ZP),{type:"primary",onClick:b},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(t)("common.actions.add")),1)]),_:1})]),toolsRight:(0,i.w5)(()=>[(0,i.Wm)(s,{value:(0,i.SU)(f).keyword,"onUpdate:value":a[0]||(a[0]=e=>(0,i.SU)(f).keyword=e),width:280,placeholder:(0,i.SU)(t)("contacts.group.search.namePlaceholder"),onSearch:a[1]||(a[1]=()=>(0,i.SU)(S)(!0))},null,8,["value","placeholder"])]),table:(0,i.w5)(()=>[(0,i.Wm)(u,{loading:(0,i.SU)(h),columns:(0,i.SU)(U),data:(0,i.SU)(g)},null,8,["loading","columns","data"])]),pageRight:(0,i.w5)(()=>[(0,i.Wm)(d,{page:(0,i.SU)(f).page,"onUpdate:page":a[2]||(a[2]=e=>(0,i.SU)(f).page=e),"page-size":(0,i.SU)(f).page_size,"onUpdate:pageSize":a[3]||(a[3]=e=>(0,i.SU)(f).page_size=e),"item-count":(0,i.SU)(v),onRefresh:(0,i.SU)(S)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(w)),(0,i.Wm)((0,i.SU)(x))]),_:1})])}}})}}]);