"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["438"],{2822:function(e,t,a){a.d(t,{Z:()=>r});var n=a(1452),l=a(2398);let r=function(e){return"number"==typeof e||(0,l.Z)(e)&&"[object Number]"==(0,n.Z)(e)}},7714:function(e,t,a){a.d(t,{Z:()=>f});var n=a(5083),l=a(209),r=a(1321),o=a(4124),i=a(2931),s=a(2249),u=a(6253),c=a(3876),d=a(8713);let p={name:"Flex",self:function(){return d.Z}},m=Object.assign(Object.assign({},r.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),f=(0,l.aZ)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:a}=(0,o.ZP)(e),u=(0,r.Z)("Flex","-flex",void 0,p,e,t);return{rtlEnabled:(0,i.V)("Flex",a,t),mergedClsPrefix:t,margin:(0,l.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,s.Tl)("gap",t)]:a}}=u.value,{row:l,col:r}=(0,n.yU)(a);return{horizontal:(0,n.fQ)(r),vertical:(0,n.fQ)(l)}})}},render(){let{vertical:e,reverse:t,align:a,inline:n,justify:r,margin:o,wrap:i,mergedClsPrefix:s,rtlEnabled:d}=this,p=(0,u.x)((0,c.z)(this),!1);return p.length?(0,l.h)("div",{role:"none",class:[`${s}-flex`,d&&`${s}-flex--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:r,flexWrap:!i||e?"nowrap":"wrap",alignItems:a,gap:`${o.vertical}px ${o.horizontal}px`}},p):null}})},1625:function(e,t,a){a.d(t,{WH:()=>o,hI:()=>r,iE:()=>u,mD:()=>s,sS:()=>i,vi:()=>c});var n=a(4203);let{t:l}=a(4958).Z.global,r=e=>n.e.get("/contact/group/list",{params:e}),o=()=>n.e.get("/contact/group/all"),i=e=>n.e.post("/contact/group/create",e,{fetchOptions:{loading:l("contacts.group.loading.createGroup"),successMessage:!0}}),s=e=>n.e.post("/contact/group/update",e,{fetchOptions:{loading:l("contacts.group.loading.updateGroup"),successMessage:!0}}),u=e=>n.e.post("/contact/group/delete",e,{fetchOptions:{loading:l("contacts.group.loading.deleteGroup"),successMessage:!0}}),c=e=>n.e.post("/contact/group/contact_count",e)},2748:function(e,t,a){a.d(t,{Z:()=>r});var n=a(8454),l=a(209);let r=(0,l.aZ)({__name:"index",props:(0,l.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,l.Vf)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:r}=t,o=(0,l.iH)(null),i=(0,l.tT)(e,"value"),s=()=>{r("search",i.value)};return a({focus:()=>{var e;null===(e=o.value)||void 0===e||e.focus()}}),(e,t)=>{let a=n.Z;return(0,l.wg)(),(0,l.j4)(a,(0,l.dG)({ref_key:"inputRef",ref:o,value:i.value,"onUpdate:value":t[0]||(t[0]=e=>i.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,l.D2)(s,["enter"])}),(0,l.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,l.w5)(()=>[(0,l._)("div",{class:"flex items-center cursor-pointer",onClick:s},t[1]||(t[1]=[(0,l._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,l.w5)(()=>[(0,l._)("div",{class:"flex items-center cursor-pointer",onClick:s},t[2]||(t[2]=[(0,l._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},8406:function(e,t,a){a.r(t),a.d(t,{default:()=>R});var n=a(4652),l=a(6818),r=a(3435),o=a(6635),i=a(2748),s=a(209),u=a(3447),c=a(7714),d=a(3312),p=a(6949),m=a(2965),f=a(1625),g=a(3951),v=a(6714),h=a(6883),_=a(8454),y=a(5822),w=a(5778);let x={class:"pt-12px"},S={class:"flex-1"},U={class:"mt-16px text-desc"},b={class:"mr-4px"},Z={class:"mt-8px text-desc"},W=(0,s.aZ)({__name:"GroupAdd",setup(e){let{t}=(0,w.QT)(),a=(0,s.AE)("formRef"),n=(0,s.qj)({create_type:2,name:"",file_data:"",file_type:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},r=e=>{let t=new FileReader;t.onload=t=>{var a;n.file_type=e.name.substring(e.name.lastIndexOf(".")+1),n.file_data=null===(a=t.target)||void 0===a?void 0:a.result},e.file&&t.readAsText(e.file)},o=async()=>{await (0,y.Sv)({file_path:"/opt/Billion-Mail/data/example_recipients.txt"})},[i,c]=(0,d.d)({onChangeState:e=>{e&&(n.name="")},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,f.sS)((0,s.IU)(n));let t=c.getState();null==t||t.refresh()}});return(e,c)=>{let d=_.Z,p=h.ZP,m=v.Z,f=u.ZP,y=g.Z;return(0,s.wg)(),(0,s.j4)((0,s.SU)(i),{title:(0,s.SU)(t)("contacts.group.add.title"),width:"500"},{default:(0,s.w5)(()=>[(0,s._)("div",x,[(0,s.Wm)(y,{ref_key:"formRef",ref:a,model:(0,s.SU)(n),rules:l},{default:(0,s.w5)(()=>[(0,s.Wm)(p,{label:(0,s.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,s.w5)(()=>[(0,s.Wm)(d,{value:(0,s.SU)(n).name,"onUpdate:value":c[0]||(c[0]=e=>(0,s.SU)(n).name=e)},null,8,["value"])]),_:1},8,["label"]),(0,s.Wm)(p,{label:(0,s.SU)(t)("contacts.group.form.file"),path:"file_data"},{default:(0,s.w5)(()=>[(0,s._)("div",S,[(0,s.Wm)(m,{"is-upload":!1,accept:["txt"],onChange:r}),(0,s._)("div",U,[(0,s._)("span",b,(0,s.zw)((0,s.SU)(t)("contacts.group.fileUpload.hint")),1),(0,s.Wm)(f,{text:"",type:"primary",onClick:o},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)(e.$t("common.actions.download")),1)]),_:1})]),(0,s._)("div",Z,(0,s.zw)((0,s.SU)(t)("contacts.group.fileUpload.emptyHint")),1)])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}}),k={class:"pt-12px"},C=(0,s.aZ)({__name:"GroupRename",setup(e){let{t}=(0,w.QT)(),a=(0,s.AE)("formRef"),n=(0,s.qj)({group_id:0,name:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},[r,o]=(0,d.d)({onChangeState:e=>{if(e){let{row:e}=o.getState();e&&(n.group_id=e.id,n.name=e.name)}else n.group_id=0,n.name=""},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,f.mD)((0,s.IU)(n));let t=o.getState();null==t||t.refresh()}});return(e,o)=>{let i=_.Z,u=h.ZP,c=g.Z;return(0,s.wg)(),(0,s.j4)((0,s.SU)(r),{title:(0,s.SU)(t)("contacts.group.rename.title"),width:"400"},{default:(0,s.w5)(()=>[(0,s._)("div",k,[(0,s.Wm)(c,{ref_key:"formRef",ref:a,model:(0,s.SU)(n),rules:l},{default:(0,s.w5)(()=>[(0,s.Wm)(u,{label:(0,s.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,s.w5)(()=>[(0,s.Wm)(i,{value:(0,s.SU)(n).name,"onUpdate:value":o[0]||(o[0]=e=>(0,s.SU)(n).name=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var z=a(5e3);function j(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,s.lA)(e)}let R=(0,s.aZ)({__name:"index",setup(e){let{t}=(0,w.QT)(),a=(0,z.tv)(),{tableParams:g,tableList:v,loading:h,tableTotal:_,getTableData:y}=(0,p.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:f.hI}),x=(0,s.iH)([{key:"name",title:t("contacts.group.columns.name"),minWidth:120,render:e=>(0,s.Wm)(u.ZP,{text:!0,type:"primary",onClick:()=>{a.push({path:"/contacts/subscribers",state:{group_id:e.id}})}},{default:()=>[e.name]})},{key:"total_count",title:t("contacts.group.columns.subscribers"),minWidth:100,render:e=>e.total_count||0},{key:"unsubscribe_count",title:t("contacts.group.columns.unsubscribe"),minWidth:100,render:e=>e.unsubscribe_count||0},{key:"create_time",title:t("contacts.group.columns.createdAt"),minWidth:140,render:e=>(0,m.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let a,n;return(0,s.Wm)(c.Z,{inline:!0},{default:()=>[(0,s.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{R(e)}},j(a=t("common.actions.rename"))?a:{default:()=>[a]}),(0,s.Wm)(u.ZP,{type:"error",text:!0,onClick:()=>{P(e)}},j(n=t("common.actions.delete"))?n:{default:()=>[n]})]})}}]),[S,U]=(0,d.d)({component:W,state:{refresh:y}}),b=()=>{U.open()},[Z,k]=(0,d.d)({component:C,state:{refresh:y}}),R=e=>{k.setState({row:e}),k.open()},P=e=>{(0,m.iG)({title:t("contacts.group.delete.title"),content:t("contacts.group.delete.confirm",{name:e.name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,f.iE)({group_ids:[e.id]}),y()}})};return(e,a)=>{let c=i.Z,d=o.Z,p=r.Z,m=l.Z,f=n.Z;return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(f,null,{toolsLeft:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(u.ZP),{type:"primary",onClick:b},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t)("common.actions.add")),1)]),_:1})]),toolsRight:(0,s.w5)(()=>[(0,s.Wm)(c,{value:(0,s.SU)(g).keyword,"onUpdate:value":a[0]||(a[0]=e=>(0,s.SU)(g).keyword=e),width:280,placeholder:(0,s.SU)(t)("contacts.group.search.namePlaceholder"),onSearch:a[1]||(a[1]=()=>(0,s.SU)(y)(!0))},null,8,["value","placeholder"])]),table:(0,s.w5)(()=>[(0,s.Wm)(p,{loading:(0,s.SU)(h),columns:(0,s.SU)(x),data:(0,s.SU)(v)},{empty:(0,s.w5)(()=>[(0,s.Wm)(d)]),_:1},8,["loading","columns","data"])]),pageRight:(0,s.w5)(()=>[(0,s.Wm)(m,{page:(0,s.SU)(g).page,"onUpdate:page":a[2]||(a[2]=e=>(0,s.SU)(g).page=e),"page-size":(0,s.SU)(g).page_size,"onUpdate:pageSize":a[3]||(a[3]=e=>(0,s.SU)(g).page_size=e),"item-count":(0,s.SU)(_),onRefresh:(0,s.SU)(y)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(S)),(0,s.Wm)((0,s.SU)(Z))]),_:1})])}}})}}]);