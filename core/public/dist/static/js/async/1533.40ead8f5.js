"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["1533"],{31651:function(e,t,a){a.d(t,{A8:()=>n,NI:()=>i,QB:()=>r,WF:()=>d,Xc:()=>m,ef:()=>u,ij:()=>o});var l=a(34541);function n(e){return l.e.get("/email_template/list",{params:e})}function i(){return l.e.get("/email_template/all")}function o(e){return l.e.get("/email_template/get",{params:e})}function d(e){return l.e.post("/email_template/create",e,{fetchOptions:{loading:"Creating template, please wait...",successMessage:!0}})}function r(e){return l.e.post("/email_template/update",e,{fetchOptions:{loading:"Updating template, please wait...",successMessage:!0}})}function u(e){return l.e.post("/email_template/copy",e,{fetchOptions:{loading:"Copying template, please wait...",successMessage:!0}})}function m(e){return l.e.post("/email_template/delete",e,{fetchOptions:{loading:"Deleting template, please wait...",successMessage:!0}})}},20665:function(e,t,a){a.d(t,{Z:()=>d});var l=a(60579),n=a(58786),i=a(6768);let o=(0,n.aZ)({__name:"index",props:(0,n.Vf)({language:{type:String,default:"html"},theme:{type:String,default:"vs-dark"},options:{type:Object,default:()=>({})}},{value:{default:""},valueModifiers:{}}),emits:(0,n.Vf)(["save"],["update:value"]),setup(e,t){let{expose:a,emit:o}=t,d=(0,n.tT)(e,"value"),r=(0,n.iH)(null),u=null,m=(0,n.iH)(!1);i.Z.config({paths:{vs:`${location.origin}/static/plugin/monaco/min/vs`}});let p=async()=>{if(r.value&&!u)try{m.value=!0;let t=await i.Z.init();(u=t.editor.create(r.value,{value:d.value,language:e.language,theme:e.theme,minimap:{enabled:!1},automaticLayout:!0,scrollBeyondLastLine:!1,fontSize:14,tabSize:2,wordWrap:"on",...e.options})).onDidChangeModelContent(()=>{d.value=(null==u?void 0:u.getValue())||""}),u.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyS,function(){o("save")})}finally{m.value=!1}},s=()=>{u&&(u.dispose(),u=null)};return(0,n.YP)(()=>d.value,e=>{u&&e!==u.getValue()&&u.setValue(e)}),(0,n.bv)(()=>{p()}),(0,n.Jd)(()=>{s()}),a({getEditor:()=>u}),(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,{class:"h-full",show:(0,n.SU)(m)},{default:(0,n.w5)(()=>[(0,n._)("div",{ref_key:"containerRef",ref:r,class:"monaco-editor-container"},null,512)]),_:1},8,["show"])}}}),d=(0,a(41748).default)(o,[["__scopeId","data-v-5b65e670"]])},53472:function(e,t,a){a.d(t,{Z:()=>i});var l=a(58786);let n=["height","srcdoc"],i=(0,l.aZ)({__name:"index",props:{value:{type:String,default:""},height:{type:[String,Number],default:"100%"}},setup:e=>(t,a)=>((0,l.wg)(),(0,l.iD)("iframe",{width:"100%",height:e.height,srcdoc:e.value,style:{border:"none",borderRadius:"4px"}},null,8,n))})},86559:function(e,t,a){a.d(t,{Z:()=>i});var l=a(73084),n=a(58786);let i=(0,n.aZ)({__name:"index",props:(0,n.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,n.Vf)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:i}=t,o=(0,n.iH)(null),d=(0,n.tT)(e,"value"),r=()=>{i("search",d.value)};return a({focus:()=>{var e;null==(e=o.value)||e.focus()}}),(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,(0,n.dG)({ref_key:"inputRef",ref:o,value:d.value,"onUpdate:value":t[0]||(t[0]=e=>d.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,n.D2)(r,["enter"])}),(0,n.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,n.w5)(()=>[(0,n._)("div",{class:"flex items-center cursor-pointer",onClick:r},t[1]||(t[1]=[(0,n._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,n.w5)(()=>[(0,n._)("div",{class:"flex items-center cursor-pointer",onClick:r},t[2]||(t[2]=[(0,n._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},46244:function(e,t,a){a.d(t,{Z:()=>i});var l=a(98048),n=a(58786);let i=(0,n.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,t){let{expose:a}=t,i=(0,n.iH)(null);return a({validate:()=>{var e;return null==(e=i.value)?void 0:e.validate()},restoreValidation:()=>{var e;return null==(e=i.value)?void 0:e.restoreValidation()}}),(e,t)=>{let a=l.Z;return(0,n.wg)(),(0,n.j4)(a,(0,n.dG)(e.$attrs,{ref_key:"formRef",ref:i,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},74881:function(e,t,a){a.r(t),a.d(t,{default:()=>j});var l=a(39244),n=a(25170),i=a(75754),o=a(66760),d=a(86559),r=a(58786),u=a(67655),m=a(53903),p=a(93953),s=a(51169),c=a(67512),f=a(68271),v=a(31651),_=a(46244),g=a(6455),h=a(20665),y=a(81833),w=a(8490),S=a(37864),U=a(73084);let k={class:"flex-1 h-580px"},Z=(0,r.aZ)({__name:"TemplateForm",setup(e){let t=(0,r.RC)(()=>Promise.all([a.e("7303"),a.e("9780"),a.e("5513"),a.e("7502")]).then(a.bind(a,19811))),l=(0,r.iH)(!1),n=(0,r.Fl)(()=>l.value?"Edit template":"New template"),i=(0,r.iH)(0),o=(0,r.qj)({temp_name:"",add_type:0,html_content:"",drag_data:""}),d=[{label:"HTML",value:0},{label:"Drag",value:1}],m=(0,r.Fl)(()=>{var e;return(null==(e=d.find(e=>e.value===o.add_type))?void 0:e.label)||""}),p=()=>{let e=f.getState();e.preview&&e.preview(o.html_content)},[c,f]=(0,s.d)({onChangeState:e=>{if(e){let e=f.getState(),{row:t}=e;l.value=e.isEdit,t&&(i.value=t.id,o.temp_name=t.temp_name,o.add_type=t.add_type,o.html_content=t.html_content,o.drag_data=t.drag_data)}else i.value=0,o.temp_name="",o.add_type=0,o.html_content="",o.drag_data=""},onConfirm:async()=>{l.value?await (0,v.QB)({id:i.value,...(0,r.IU)(o)}):await (0,v.WF)((0,r.IU)(o)),f.getState().refresh()}});return(e,a)=>{let i=U.Z,s=S.ZP,f=w.Z,v=y.Z,Z=h.Z,b=g.ZP,W=_.Z,x=u.ZP;return(0,r.wg)(),(0,r.j4)((0,r.SU)(c),{title:(0,r.SU)(n),width:1200},{"footer-left":(0,r.w5)(()=>[(0,r.Wm)(x,{type:"primary",ghost:"",onClick:p},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)(e.$t("common.actions.preview")),1)]),_:1})]),default:(0,r.w5)(()=>[(0,r.Wm)(W,{class:"pt-8px",model:(0,r.SU)(o)},{default:(0,r.w5)(()=>[(0,r.Wm)(v,{cols:24,"x-gap":24},{default:(0,r.w5)(()=>[(0,r.Wm)(s,{span:18,label:"Name",path:"temp_name"},{default:(0,r.w5)(()=>[(0,r.Wm)(i,{value:(0,r.SU)(o).temp_name,"onUpdate:value":a[0]||(a[0]=e=>(0,r.SU)(o).temp_name=e),placeholder:e.$t("market.template.add.namePlaceholder")},null,8,["value","placeholder"])]),_:1}),(0,r.Wm)(s,{span:6,label:"Type",path:"add_type"},{default:(0,r.w5)(()=>[(0,r.Wm)(f,{value:(0,r.SU)(o).add_type,"onUpdate:value":a[1]||(a[1]=e=>(0,r.SU)(o).add_type=e),disabled:(0,r.SU)(l),options:d},null,8,["value","disabled"])]),_:1})]),_:1}),(0,r.Wm)(b,{label:(0,r.SU)(m),"show-feedback":!1},{default:(0,r.w5)(()=>[(0,r._)("div",k,[1===(0,r.SU)(o).add_type?((0,r.wg)(),(0,r.j4)((0,r.SU)(t),{key:0,config:(0,r.SU)(o).drag_data,"onUpdate:config":a[2]||(a[2]=e=>(0,r.SU)(o).drag_data=e),html:(0,r.SU)(o).html_content,"onUpdate:html":a[3]||(a[3]=e=>(0,r.SU)(o).html_content=e)},null,8,["config","html"])):(0,r.kq)("",!0),0===(0,r.SU)(o).add_type?((0,r.wg)(),(0,r.j4)(Z,{key:1,value:(0,r.SU)(o).html_content,"onUpdate:value":a[4]||(a[4]=e=>(0,r.SU)(o).html_content=e),language:"html"},null,8,["value"])):(0,r.kq)("",!0)])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var b=a(53472);let W=(0,r.aZ)({__name:"TemplatePreview",setup(e){let t=(0,r.iH)(""),[a,l]=(0,s.d)({onChangeState:e=>{e&&(t.value=l.getState().html||"")}});return(e,l)=>{let n=b.Z;return(0,r.wg)(),(0,r.j4)((0,r.SU)(a),{title:e.$t("market.template.preview.title"),width:"820",footer:!1},{default:(0,r.w5)(()=>[(0,r.Wm)(n,{height:580,value:(0,r.SU)(t)},null,8,["value"])]),_:1},8,["title"])}}});var x=a(52495);function C(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,r.lA)(e)}let P=(0,r.aZ)({__name:"index",setup(e){let{t}=(0,x.QT)(),{tableParams:a,tableList:_,loading:g,tableTotal:h,getTableData:y}=(0,c.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:v.A8}),w=(0,r.iH)([{key:"temp_name",title:t("market.template.columns.name"),minWidth:120,ellipsis:{tooltip:!0},render:e=>(0,r.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{b(e)}},{default:()=>[e.temp_name]})},{key:"add_type",title:"Type",minWidth:140,render:e=>1===e.add_type?(0,r.Wm)(m.ZP,{size:"small",bordered:!1,type:"primary"},{default:()=>[(0,r.Uk)("Drag")]}):0===e.add_type?(0,r.Wm)(m.ZP,{size:"small",bordered:!1,type:"info"},{default:()=>[(0,r.Uk)("HTML")]}):void 0},{key:"create_time",title:t("market.template.columns.createdAt"),minWidth:140,render:e=>(0,f.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:240,render:e=>{let a,l,n,i;return(0,r.Wm)(p.Z,{inline:!0},{default:()=>[(0,r.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{z(e.html_content)}},C(a=t("common.actions.preview"))?a:{default:()=>[a]}),(0,r.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{b(e)}},C(l=t("common.actions.edit"))?l:{default:()=>[l]}),(0,r.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{T(e)}},C(n=t("market.template.actions.duplicate"))?n:{default:()=>[n]}),(0,r.Wm)(u.ZP,{type:"error",text:!0,onClick:()=>{H(e)}},C(i=t("common.actions.delete"))?i:{default:()=>[i]})]})}}]),[S,U]=(0,s.d)({component:Z,state:{isEdit:!1,refresh:y,preview:e=>{z(e)}}}),k=()=>{U.setState({isEdit:!1,row:null}),U.open()},b=e=>{U.setState({isEdit:!0,row:e}),U.open()},[P,j]=(0,s.d)({component:W}),z=e=>{j.setState({html:e}),j.open()},T=async e=>{await (0,v.ef)({id:e.id}),y()},H=e=>{(0,f.iG)({title:t("market.template.delete.title"),content:t("market.template.delete.confirm",{name:e.temp_name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,v.Xc)({id:e.id}),y()}})};return(e,m)=>{let p=d.Z,s=o.Z,c=i.Z,f=n.Z,v=l.Z;return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(v,null,{toolsLeft:(0,r.w5)(()=>[(0,r.Wm)((0,r.SU)(u.ZP),{type:"primary",onClick:k},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)((0,r.SU)(t)("market.template.actions.add")),1)]),_:1})]),toolsRight:(0,r.w5)(()=>[(0,r.Wm)(p,{value:(0,r.SU)(a).keyword,"onUpdate:value":m[0]||(m[0]=e=>(0,r.SU)(a).keyword=e),width:240,placeholder:(0,r.SU)(t)("market.template.search.namePlaceholder"),onSearch:m[1]||(m[1]=()=>(0,r.SU)(y)(!0))},null,8,["value","placeholder"])]),table:(0,r.w5)(()=>[(0,r.Wm)(c,{loading:(0,r.SU)(g),columns:(0,r.SU)(w),data:(0,r.SU)(_)},{empty:(0,r.w5)(()=>[(0,r.Wm)(s)]),_:1},8,["loading","columns","data"])]),pageRight:(0,r.w5)(()=>[(0,r.Wm)(f,{page:(0,r.SU)(a).page,"onUpdate:page":m[2]||(m[2]=e=>(0,r.SU)(a).page=e),"page-size":(0,r.SU)(a).page_size,"onUpdate:pageSize":m[3]||(m[3]=e=>(0,r.SU)(a).page_size=e),"item-count":(0,r.SU)(h),onRefresh:(0,r.SU)(y)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,r.w5)(()=>[(0,r.Wm)((0,r.SU)(S)),(0,r.Wm)((0,r.SU)(P))]),_:1})])}}}),j=(0,a(41748).default)(P,[["__scopeId","data-v-bd779390"]])}}]);