"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["212"],{55:function(e,a,l){l.d(a,{Au:()=>m,Fj:()=>s,LC:()=>n,OV:()=>r,dj:()=>d,gK:()=>u,i7:()=>o,v1:()=>p,yW:()=>c});var t=l(4203);let{t:i}=l(4958).Z.global,o=e=>t.e.get("/domains/list",{params:e}),n=()=>t.e.get("/domains/all"),s=e=>t.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),u=e=>t.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),d=e=>t.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),r=e=>t.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),m=e=>t.e.get("/domains/get_ssl",{params:e}),p=e=>t.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),c=e=>t.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}})},4361:function(e,a,l){l.d(a,{EV:()=>s,Ts:()=>n,WS:()=>u,iC:()=>o});var t=l(4203);let{t:i}=l(4958).Z.global,o=e=>t.e.get("/mailbox/list",{params:e}),n=e=>t.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),s=e=>t.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),u=e=>t.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}})},3776:function(e,a,l){l.d(a,{F:()=>n});var t=l(2965),i=l(4059),o=l(4958);let n=()=>{let{t:e}=o.Z.global,{copy:a,isSupported:l}=(0,i.VPI)({legacy:!0});return{copyText:async i=>{if(!i){t.v0.error(e("common.useCopy.noText"));return}l.value?(await a(i),t.v0.success(e("common.useCopy.success"))):t.v0.error(e("common.useCopy.failed"))}}}},2748:function(e,a,l){l.d(a,{Z:()=>o});var t=l(8454),i=l(209);let o=(0,i.aZ)({__name:"index",props:(0,i.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,i.Vf)(["search"],["update:value"]),setup(e,a){let{expose:l,emit:o}=a,n=(0,i.iH)(null),s=(0,i.tT)(e,"value"),u=()=>{o("search",s.value)};return l({focus:()=>{var e;null===(e=n.value)||void 0===e||e.focus()}}),(e,a)=>{let l=t.Z;return(0,i.wg)(),(0,i.j4)(l,(0,i.dG)({ref_key:"inputRef",ref:n,value:s.value,"onUpdate:value":a[0]||(a[0]=e=>s.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,i.D2)(u,["enter"])}),(0,i.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,i.w5)(()=>[(0,i._)("div",{class:"flex items-center cursor-pointer",onClick:u},a[1]||(a[1]=[(0,i._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,i.w5)(()=>[(0,i._)("div",{class:"flex items-center cursor-pointer",onClick:u},a[2]||(a[2]=[(0,i._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},3951:function(e,a,l){l.d(a,{Z:()=>o});var t=l(9833),i=l(209);let o=(0,i.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,a){let{expose:l}=a,o=(0,i.iH)(null);return l({validate:()=>{var e;return null===(e=o.value)||void 0===e?void 0:e.validate()},restoreValidation:()=>{var e;return null===(e=o.value)||void 0===e?void 0:e.restoreValidation()}}),(e,a)=>{let l=t.Z;return(0,i.wg)(),(0,i.j4)(l,(0,i.dG)(e.$attrs,{ref_key:"formRef",ref:o,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,i.w5)(()=>[(0,i.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},6865:function(e,a,l){l.r(a),l.d(a,{default:()=>V});var t=l(4652),i=l(6818),o=l(3435),n=l(6635),s=l(2748),u=l(209),d=l(3447),r=l(9946),m=l(7714),p=l(2965),c=l(3312),v=l(3776),f=l(6949),g=l(4361),w=l(5476);let b={class:"flex"},x={class:"w-0 flex-1 flex items-center"},h={class:"min-w-0"},_=(0,u.aZ)({__name:"index",props:{value:{default:""}},setup(e){let{copyText:a}=(0,v.F)(),l=(0,u.iH)(!1),t=(0,u.Fl)(()=>l.value?e.value:"**********"),i=()=>{l.value=!l.value},o=async()=>{a(`${e.value}`)};return(e,a)=>{let n=w.ZP;return(0,u.wg)(),(0,u.iD)("div",b,[(0,u._)("div",x,[(0,u._)("div",h,[(0,u.Wm)(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:(0,u.w5)(()=>[(0,u.Uk)((0,u.zw)((0,u.SU)(t)),1)]),_:1})]),(0,u._)("div",{class:"ml-6px text-15px cursor-pointer",title:"Show",onClick:i},[(0,u._)("i",{class:(0,u.C_)((0,u.SU)(l)?"i-mdi-eye-outline":"i-mdi-eye-off-outline")},null,2)]),(0,u._)("div",{class:"reset ml-6px text-15px cursor-pointer text-#333",title:"Copy",onClick:o},a[0]||(a[0]=[(0,u._)("i",{class:"i-mdi-content-copy"},null,-1)]))])])}}});var U=l(5891),S=l(55),y=l(5778);let W=(0,u.aZ)({__name:"DomainSelect",props:(0,u.Vf)({isAll:{type:Boolean,default:!0}},{value:{default:()=>null},valueModifiers:{}}),emits:["update:value"],setup(e){let{t:a}=(0,y.QT)(),l=(0,u.tT)(e,"value"),t=(0,u.iH)(!1),i=(0,u.iH)([]);return(async()=>{try{t.value=!0;let o=await (0,S.LC)();(0,p.kJ)(o)&&(i.value=o.map(e=>({label:e.domain,value:e.domain})),e.isAll?(i.value.unshift({label:a("common.all.text"),value:""}),l.value=""):o.length>0&&!l.value&&(l.value=o[0].domain))}finally{t.value=!1}})(),(e,o)=>{let n=U.Z;return(0,u.wg)(),(0,u.j4)(n,{value:l.value,"onUpdate:value":o[0]||(o[0]=e=>l.value=e),loading:(0,u.SU)(t),filterable:!0,options:(0,u.SU)(i),placeholder:(0,u.SU)(a)("mailbox.domain.selectPlaceholder")},null,8,["value","loading","options","placeholder"])}}}),Z=(0,l(5115).default)(W,[["__scopeId","data-v-59ecdb27"]]);var k=l(3951),C=l(4603),T=l(6883),q=l(3858),A=l(8454);let M=(0,u.aZ)({__name:"MailboxForm",setup(e){let{t:a}=(0,y.QT)(),l=(0,u.iH)(!1),t=(0,u.Fl)(()=>l.value?a("mailbox.form.editTitle"):a("mailbox.form.addTitle")),i=(0,u.AE)("formRef"),o=(0,u.qj)({quota:5,unit:"GB",isAdmin:0,full_name:"",domain:null,password:"",active:1}),n=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],s=[{label:a("mailbox.userType.general"),value:0},{label:a("mailbox.userType.admin"),value:1}],d={full_name:{trigger:"blur",validator:()=>""!==o.full_name.trim()&&!!o.domain||Error(a("mailbox.validation.emailRequired"))},password:{trigger:"blur",validator:()=>{if(l.value){if(o.password&&o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(o.password&&!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}else{if(o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}return!0}}},m=(e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e},v=()=>({full_name:o.full_name,domain:o.domain||"",password:o.password,quota:m(o.quota,o.unit),isAdmin:o.isAdmin,active:o.active}),[f,w]=(0,c.d)({onChangeState:e=>{if(e){let e=w.getState(),{row:a}=e;if(l.value=e.isEdit,a){o.full_name=a.full_name,o.domain=a.domain,o.isAdmin=a.is_admin,o.active=a.active;let[e,l]=(0,p.UO)(a.quota).split(" ");o.quota=(0,p.Dx)(e),o.unit=l}}else o.full_name="",o.domain=null,o.password="",o.quota=5,o.unit="GB",o.isAdmin=0,o.active=1},onConfirm:async()=>{var e;await (null===(e=i.value)||void 0===e?void 0:e.validate());let a=v();l.value?await (0,g.EV)(a):await (0,g.Ts)(a),w.getState().refresh()}});return(e,m)=>{let p=A.Z,c=q.Z,v=T.ZP,g=C.Z,w=U.Z,b=r.Z,x=k.Z;return(0,u.wg)(),(0,u.j4)((0,u.SU)(f),{title:(0,u.SU)(t),width:"520"},{default:(0,u.w5)(()=>[(0,u.Wm)(x,{ref_key:"formRef",ref:i,class:"pt-20px",model:(0,u.SU)(o),rules:d},{default:(0,u.w5)(()=>[(0,u.Wm)(v,{label:(0,u.SU)(a)("mailbox.form.emailAddress"),path:"full_name"},{default:(0,u.w5)(()=>[(0,u.Wm)(c,null,{default:(0,u.w5)(()=>[(0,u.Wm)(p,{value:(0,u.SU)(o).full_name,"onUpdate:value":m[0]||(m[0]=e=>(0,u.SU)(o).full_name=e),class:"flex-1",disabled:(0,u.SU)(l)},null,8,["value","disabled"]),(0,u.Wm)(Z,{value:(0,u.SU)(o).domain,"onUpdate:value":m[1]||(m[1]=e=>(0,u.SU)(o).domain=e),class:"flex-1","is-all":!1,disabled:(0,u.SU)(l)},null,8,["value","disabled"])]),_:1})]),_:1},8,["label"]),(0,u.Wm)(v,{label:(0,u.SU)(a)("mailbox.form.password"),path:"password"},{default:(0,u.w5)(()=>[(0,u.Wm)(p,{value:(0,u.SU)(o).password,"onUpdate:value":m[2]||(m[2]=e=>(0,u.SU)(o).password=e),placeholder:(0,u.SU)(a)("mailbox.form.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,u.Wm)(v,{label:(0,u.SU)(a)("mailbox.form.quota"),path:"quota"},{default:(0,u.w5)(()=>[(0,u.Wm)(c,null,{default:(0,u.w5)(()=>[(0,u.Wm)(g,{value:(0,u.SU)(o).quota,"onUpdate:value":m[3]||(m[3]=e=>(0,u.SU)(o).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,u.Wm)(w,{value:(0,u.SU)(o).unit,"onUpdate:value":m[4]||(m[4]=e=>(0,u.SU)(o).unit=e),class:"flex-1",options:n},null,8,["value"])]),_:1})]),_:1},8,["label"]),(0,u.Wm)(v,{label:(0,u.SU)(a)("mailbox.form.userType"),path:"userType"},{default:(0,u.w5)(()=>[(0,u.Wm)(w,{value:(0,u.SU)(o).isAdmin,"onUpdate:value":m[5]||(m[5]=e=>(0,u.SU)(o).isAdmin=e),options:s},null,8,["value"])]),_:1},8,["label"]),(0,u.Wm)(v,{label:(0,u.SU)(a)("mailbox.form.status"),"show-feedback":!1},{default:(0,u.w5)(()=>[(0,u.Wm)(b,{value:(0,u.SU)(o).active,"onUpdate:value":m[6]||(m[6]=e=>(0,u.SU)(o).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}}),O={class:"p-24px"},E={class:"bt-title"},z={class:"w-220px"};function P(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,u.lA)(e)}let V=(0,u.aZ)({__name:"index",setup(e){let{t:a}=(0,y.QT)(),{copyText:l}=(0,v.F)(),{tableParams:w,tableList:b,loading:x,tableTotal:h,getTableData:U}=(0,f.Z)({loading:!0,immediate:!1,params:{page:1,page_size:10,domain:null,keyword:""},fetchFn:g.iC}),S=(0,u.iH)([{key:"username",title:a("mailbox.columns.username"),minWidth:120,ellipsis:{tooltip:!0}},{key:"password",title:a("mailbox.columns.password"),width:"18%",minWidth:120,render:e=>(0,u.Wm)(_,{value:e.password||"--"},null)},{key:"login",title:a("mailbox.columns.loginInfo"),render:e=>{let t;return(0,u.Wm)(d.ZP,{text:!0,type:"primary",onClick:()=>{l(a("mailbox.loginInfo.template",{webmail:window.location.origin+"/roundcube",username:e.username,password:e.password}))}},P(t=a("common.actions.copy"))?t:{default:()=>[t]})}},{key:"quota",title:a("mailbox.columns.quota"),width:"14%",minWidth:120,render:e=>(0,p.UO)(e.quota)},{key:"is_admin",title:a("mailbox.columns.type"),width:"14%",minWidth:100,render:e=>1===e.is_admin?a("mailbox.userType.admin"):a("mailbox.userType.general")},{key:"status",title:a("mailbox.columns.status"),width:"12%",minWidth:80,render:e=>(0,u.Wm)(r.Z,{value:e.active,"checked-value":1,"unchecked-value":0,size:"small",onUpdateValue:a=>{T(e,a)}},null)},{title:a("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let l,t;return(0,u.Wm)(m.Z,{inline:!0},{default:()=>[(0,u.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{q(e)}},P(l=a("common.actions.edit"))?l:{default:()=>[l]}),(0,u.Wm)(d.ZP,{type:"error",text:!0,onClick:()=>{A(e)}},P(t=a("common.actions.delete"))?t:{default:()=>[t]})]})}}]),[W,k]=(0,c.d)({component:M,state:{isEdit:!1,refresh:U}}),C=()=>{k.setState({isEdit:!1,row:null}),k.open()},T=async(e,a)=>{await (0,g.EV)({full_name:e.full_name,domain:e.domain,password:e.password,quota:e.quota,isAdmin:e.is_admin,active:a}),e.active=a},q=e=>{k.setState({isEdit:!0,row:e}),k.open()},A=e=>{(0,p.iG)({title:a("mailbox.delete.title"),content:a("mailbox.delete.confirm",{name:e.username}),confirmText:a("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,g.WS)({email:e.username}),U()}})};return(e,l)=>{let r=s.Z,m=n.Z,p=o.Z,c=i.Z,v=t.Z;return(0,u.wg)(),(0,u.iD)("div",O,[(0,u._)("div",E,(0,u.zw)((0,u.SU)(a)("layout.menu.mailboxes")),1),(0,u.Wm)(v,null,{toolsLeft:(0,u.w5)(()=>[(0,u.Wm)((0,u.SU)(d.ZP),{type:"primary",onClick:C},{default:(0,u.w5)(()=>[(0,u.Uk)((0,u.zw)((0,u.SU)(a)("mailbox.actions.add")),1)]),_:1})]),toolsRight:(0,u.w5)(()=>[(0,u._)("div",z,[(0,u.Wm)(Z,{value:(0,u.SU)(w).domain,"onUpdate:value":[l[0]||(l[0]=e=>(0,u.SU)(w).domain=e),l[1]||(l[1]=()=>(0,u.SU)(U)(!0))]},null,8,["value"])]),(0,u.Wm)(r,{value:(0,u.SU)(w).keyword,"onUpdate:value":l[2]||(l[2]=e=>(0,u.SU)(w).keyword=e),width:"280",placeholder:(0,u.SU)(a)("mailbox.search.usernamePlaceholder"),onSearch:l[3]||(l[3]=()=>(0,u.SU)(U)(!0))},null,8,["value","placeholder"])]),table:(0,u.w5)(()=>[(0,u.Wm)(p,{loading:(0,u.SU)(x),columns:(0,u.SU)(S),data:(0,u.SU)(b)},{empty:(0,u.w5)(()=>[(0,u.Wm)(m)]),_:1},8,["loading","columns","data"])]),pageRight:(0,u.w5)(()=>[(0,u.Wm)(c,{page:(0,u.SU)(w).page,"onUpdate:page":l[4]||(l[4]=e=>(0,u.SU)(w).page=e),"page-size":(0,u.SU)(w).page_size,"onUpdate:pageSize":l[5]||(l[5]=e=>(0,u.SU)(w).page_size=e),"item-count":(0,u.SU)(h),onRefresh:(0,u.SU)(U)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,u.w5)(()=>[(0,u.Wm)((0,u.SU)(W))]),_:1})])}}})}}]);