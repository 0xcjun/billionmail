"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["3719"],{74355:function(e,t,a){a.d(t,{Z:()=>r});var l=a(25595),i=a(85905),s=a(81051);function r(e={},t){let a=(0,l.qj)({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:n,keyup:o}=e,u=e=>{switch(e.key){case"Control":a.ctrl=!0;break;case"Meta":a.command=!0,a.win=!0;break;case"Shift":a.shift=!0;break;case"Tab":a.tab=!0}void 0!==n&&Object.keys(n).forEach(t=>{if(t!==e.key)return;let a=n[t];if("function"==typeof a)a(e);else{let{stop:t=!1,prevent:l=!1}=a;t&&e.stopPropagation(),l&&e.preventDefault(),a.handler(e)}})},c=e=>{switch(e.key){case"Control":a.ctrl=!1;break;case"Meta":a.command=!1,a.win=!1;break;case"Shift":a.shift=!1;break;case"Tab":a.tab=!1}void 0!==o&&Object.keys(o).forEach(t=>{if(t!==e.key)return;let a=o[t];if("function"==typeof a)a(e);else{let{stop:t=!1,prevent:l=!1}=a;t&&e.stopPropagation(),l&&e.preventDefault(),a.handler(e)}})},d=()=>{(void 0===t||t.value)&&((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,c)),void 0!==t&&(0,l.YP)(t,e=>{e?((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,c)):((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,c))})};return(0,s.N)()?((0,l.wF)(d),(0,l.Jd)(()=>{(void 0===t||t.value)&&((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,c))})):d(),(0,l.OT)(a)}},73217:function(e,t,a){a.d(t,{Z:()=>m});var l=a(22769),i=a(82135),s=a(45988),r=a(31739),n=a(71581),o=a(25162),u=a(84342),c=a(48366),d=Object.prototype.hasOwnProperty;let m=function(e){if(null==e)return!0;if((0,n.Z)(e)&&((0,r.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,o.Z)(e)||(0,c.Z)(e)||(0,s.Z)(e)))return!e.length;var t=(0,i.Z)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,u.Z)(e))return!(0,l.Z)(e).length;for(var a in e)if(d.call(e,a))return!1;return!0}},91132:function(e,t,a){a.d(t,{W3:()=>d,ZP:()=>p});var l=a(25595),i=a(51045),s=a(87209),r=a(93715),n=a(34970),o=a(3141),u=a(49858);let c=(0,u.cB)("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[(0,u.c)("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),(0,u.c)("a",`
 color: inherit;
 text-decoration: inherit;
 `),(0,u.cB)("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[(0,u.cB)("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),(0,u.c)("&:not(:last-child)",[(0,u.cM)("clickable",[(0,u.cE)("link",`
 cursor: pointer;
 `,[(0,u.c)("&:hover",`
 background-color: var(--n-item-color-hover);
 `),(0,u.c)("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),(0,u.cE)("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[(0,u.c)("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-hover);
 `)]),(0,u.c)("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),(0,u.cE)("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),(0,u.c)("&:last-child",[(0,u.cE)("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-active);
 `)]),(0,u.cE)("separator",`
 display: none;
 `)])])]),d=(0,n.U)("n-breadcrumb"),m=Object.assign(Object.assign({},i.Z.props),{separator:{type:String,default:"/"}}),p=(0,l.aZ)({name:"Breadcrumb",props:m,setup(e){let{mergedClsPrefixRef:t,inlineThemeDisabled:a}=(0,s.ZP)(e),n=(0,i.Z)("Breadcrumb","-breadcrumb",c,o.Z,e,t);(0,l.JJ)(d,{separatorRef:(0,l.Vh)(e,"separator"),mergedClsPrefixRef:t});let u=(0,l.Fl)(()=>{let{common:{cubicBezierEaseInOut:e},self:{separatorColor:t,itemTextColor:a,itemTextColorHover:l,itemTextColorPressed:i,itemTextColorActive:s,fontSize:r,fontWeightActive:o,itemBorderRadius:u,itemColorHover:c,itemColorPressed:d,itemLineHeight:m}}=n.value;return{"--n-font-size":r,"--n-bezier":e,"--n-item-text-color":a,"--n-item-text-color-hover":l,"--n-item-text-color-pressed":i,"--n-item-text-color-active":s,"--n-separator-color":t,"--n-item-color-hover":c,"--n-item-color-pressed":d,"--n-item-border-radius":u,"--n-font-weight-active":o,"--n-item-line-height":m}}),m=a?(0,r.F)("breadcrumb",void 0,u,e):void 0;return{mergedClsPrefix:t,cssVars:a?void 0:u,themeClass:null==m?void 0:m.themeClass,onRender:null==m?void 0:m.onRender}},render(){var e;return null==(e=this.onRender)||e.call(this),(0,l.h)("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},(0,l.h)("ul",null,this.$slots))}})},89667:function(e,t,a){a.d(t,{Z:()=>n});var l=a(25595),i=a(14570),s=a(74976),r=a(91132);let n=(0,l.aZ)({name:"BreadcrumbItem",props:{separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},slots:Object,setup(e,{slots:t}){let a=(0,l.f3)(r.W3,null);if(!a)return()=>null;let{separatorRef:n,mergedClsPrefixRef:o}=a,u=function(e=s.j?window:null){let t=()=>{let{hash:t,host:a,hostname:l,href:i,origin:s,pathname:r,port:n,protocol:o,search:u}=(null==e?void 0:e.location)||{};return{hash:t,host:a,hostname:l,href:i,origin:s,pathname:r,port:n,protocol:o,search:u}},a=(0,l.iH)(t()),i=()=>{a.value=t()};return(0,l.bv)(()=>{e&&(e.addEventListener("popstate",i),e.addEventListener("hashchange",i))}),(0,l.SK)(()=>{e&&(e.removeEventListener("popstate",i),e.removeEventListener("hashchange",i))}),a}(),c=(0,l.Fl)(()=>e.href?"a":"span"),d=(0,l.Fl)(()=>u.value.href===e.href?"location":null);return()=>{let{value:a}=o;return(0,l.h)("li",{class:[`${a}-breadcrumb-item`,e.clickable&&`${a}-breadcrumb-item--clickable`]},(0,l.h)(c.value,{class:`${a}-breadcrumb-item__link`,"aria-current":d.value,href:e.href,onClick:e.onClick},t),(0,l.h)("span",{class:`${a}-breadcrumb-item__separator`,"aria-hidden":"true"},(0,i.gI)(t.separator,()=>{var t;return[null!=(t=e.separator)?t:n.value]})))}}})},14119:function(e,t,a){a.d(t,{Z:()=>u});var l=a(25595),i=a(51045),s=a(87209),r=a(87),n=a(68389);let o=Object.assign(Object.assign({},r.Kd),i.Z.props),u=(0,l.aZ)({name:"Tooltip",props:o,slots:Object,__popover__:!0,setup(e){let{mergedClsPrefixRef:t}=(0,s.ZP)(e),a=(0,i.Z)("Tooltip","-tooltip",void 0,n.Z,e,t),r=(0,l.iH)(null);return Object.assign(Object.assign({},{syncPosition(){r.value.syncPosition()},setShow(e){r.value.setShow(e)}}),{popoverRef:r,mergedTheme:a,popoverThemeOverrides:(0,l.Fl)(()=>a.value.self)})},render(){let{mergedTheme:e,internalExtraClass:t}=this;return(0,l.h)(r.ZP,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:t.concat("tooltip"),ref:"popoverRef"}),this.$slots)}})},20969:function(e,t,a){a.d(t,{WH:()=>n,hI:()=>r,iE:()=>d,mD:()=>c,sS:()=>u,uz:()=>v,vi:()=>m,yG:()=>p,yL:()=>o});var l=a(77527),i=a(86244);let{t:s}=l.Z.global,r=e=>i.e.get("/contact/group/list",{params:e}),n=()=>i.e.get("/contact/group/all"),o=e=>i.e.get("/contact/group/info",{params:e}),u=e=>i.e.post("/contact/group/create",e,{fetchOptions:{loading:s("contacts.group.loading.createGroup"),successMessage:!0}}),c=e=>i.e.post("/contact/group/update",e,{fetchOptions:{loading:s("contacts.group.loading.updateGroup"),successMessage:!0}}),d=e=>i.e.post("/contact/group/delete",e,{fetchOptions:{loading:s("contacts.group.loading.deleteGroup"),successMessage:!0}}),m=e=>i.e.post("/contact/group/contact_count",e),p=e=>i.e.post("/contact/group/export",e,{fetchOptions:{loading:s("contacts.group.loading.exportGroup"),successMessage:!0}}),v=e=>i.e.post("/contact/group/update",e,{fetchOptions:{loading:s("contacts.group.loading.saveSettings"),successMessage:!0}})},25464:function(e,t,a){a.d(t,{Au:()=>d,Fj:()=>n,LC:()=>r,Lb:()=>g,OV:()=>c,dj:()=>u,gK:()=>o,i7:()=>s,rU:()=>f,v1:()=>m,xh:()=>v,yW:()=>p});var l=a(86244);let{t:i}=a(77527).Z.global,s=e=>l.e.get("/domains/list",{params:e}),r=()=>l.e.get("/domains/all"),n=e=>l.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),u=e=>l.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),c=e=>l.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),d=e=>l.e.get("/domains/get_ssl",{params:e}),m=e=>l.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),p=e=>l.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}}),v=e=>l.e.post("/domains/set_default_domain",e,{fetchOptions:{loading:"Setting Default Domain, please wait...",successMessage:!0}}),f=e=>l.e.post("/askai/project/create",e,{fetchOptions:{loading:"Setting Default Domain, please wait...",successMessage:!0}}),g=()=>l.e.post("/askai/supplier/status")},6097:function(e,t,a){a.d(t,{EV:()=>o,H2:()=>d,Ts:()=>r,WS:()=>u,Yi:()=>n,iC:()=>s,ym:()=>c});var l=a(86244);let{t:i}=a(77527).Z.global,s=e=>l.e.get("/mailbox/list",{params:e}),r=e=>l.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),n=e=>l.e.post("/mailbox/batch_create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),u=e=>l.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}}),c=e=>l.e.post("/mailbox/export",e,{responseType:"blob",fetchOptions:{loading:i("mailbox.api.loading.exporting"),successMessage:!0}}),d=e=>l.e.post("/mailbox/import",e,{fetchOptions:{loading:i("mailbox.api.loading.importing"),successMessage:!0}})},26973:function(e,t,a){a.d(t,{Gk:()=>n,Q5:()=>m,Xr:()=>d,ZS:()=>r,_5:()=>c,gI:()=>u,jC:()=>p,ke:()=>v,mQ:()=>o,oS:()=>f});var l=a(77527),i=a(86244);let{t:s}=l.Z.global;function r(e){return i.e.get("/batch_mail/task/list",{params:e})}function n(e){return i.e.get("/batch_mail/task/stat_chart",{params:e})}function o(e){return i.e.get("/batch_mail/task/find",{params:e})}function u(e){return i.e.post("/batch_mail/task/create",e,{fetchOptions:{loading:s("market.task.loading.creating"),successMessage:!0}})}function c(e){return i.e.post("/batch_mail/task/delete",e,{fetchOptions:{loading:s("market.task.loading.deleting"),successMessage:!0}})}function d(e){return i.e.post("/batch_mail/task/pause",e,{fetchOptions:{loading:s("market.task.loading.pausing"),successMessage:!0}})}function m(e){return i.e.post("/batch_mail/task/resume",e,{fetchOptions:{loading:s("market.task.loading.resuming"),successMessage:!0}})}function p(e){return i.e.post("/batch_mail/task/send_test",e,{fetchOptions:{loading:s("market.task.loading.sendingTest"),successMessage:!0}})}function v(e){return i.e.get("/batch_mail/tracking/mail_provider",{params:e})}function f(e){return i.e.get("/batch_mail/tracking/logs",{params:e})}},81208:function(e,t,a){a.d(t,{A8:()=>r,NI:()=>n,QB:()=>u,WF:()=>o,Xc:()=>d,ef:()=>c});var l=a(77527),i=a(86244);let{t:s}=l.Z.global;function r(e){return i.e.get("/email_template/list",{params:e})}function n(){return i.e.get("/email_template/all")}function o(e){return i.e.post("/email_template/create",e,{fetchOptions:{loading:s("market.template.loading.creating"),successMessage:!0}})}function u(e){return i.e.post("/email_template/update",e,{fetchOptions:{loading:s("market.template.loading.updating"),successMessage:!0}})}function c(e){return i.e.post("/email_template/copy",e,{fetchOptions:{loading:s("market.template.loading.copying"),successMessage:!0}})}function d(e){return i.e.post("/email_template/delete",e,{fetchOptions:{loading:s("market.template.loading.deleting"),successMessage:!0}})}},59147:function(e,t,a){a.d(t,{Z:()=>s});var l=a(25595);let i=["height","srcdoc"],s=(0,l.aZ)({__name:"index",props:{value:{type:String,default:""},height:{type:[String,Number],default:"100%"}},setup:e=>(t,a)=>((0,l.wg)(),(0,l.iD)("iframe",{width:"100%",height:e.height,srcdoc:e.value,style:{border:"none",borderRadius:"4px"}},null,8,i))})},66844:function(e,t,a){a.d(t,{Z:()=>c});var l=a(46126),i=a(25595),s=a(43407),r=a(25464),n=a(6097);let o={class:"flex-1"},u={class:"flex-1 ml-10px"},c=(0,i.aZ)({__name:"FromSelect",props:{value:{},valueModifiers:{},name:{},nameModifiers:{},domain:{},domainModifiers:{}},emits:["update:value","update:name","update:domain"],setup(e){let t=(0,i.tT)(e,"value"),a=(0,i.tT)(e,"name"),c=(0,i.iH)(!1),d=(0,i.tT)(e,"domain"),m=(0,i.iH)([]),p=(0,i.iH)([]),v=(0,i.Fl)(()=>p.value.filter(e=>e.domain===d.value).map(e=>({label:e.username,value:e.username,data:e}))),f=async()=>{await (0,i.Y3)(),v.value.length>0?(t.value=v.value[0].value,g(t.value,v.value[0])):(t.value=null,a.value="")},g=(e,t)=>{let{data:l}=t;(0,s.Kn)(l)&&(a.value=l.full_name)},b=async()=>{let e=await (0,r.LC)();(0,s.kJ)(e)&&(m.value=e.map(e=>({label:e.domain,value:e.domain})),null===d.value&&e.length>0&&(d.value=e[0].domain))},k=async()=>{let e=await (0,n.iC)({page:1,page_size:1e3,domain:""});(0,s.Kn)(e)&&(p.value=e.list)};return(async()=>{try{c.value=!0,await k(),await b(),await (0,i.Y3)(),null===t.value&&f()}finally{c.value=!1}})(),(e,a)=>{let s=l.Z;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",o,[(0,i.Wm)(s,{value:d.value,"onUpdate:value":[a[0]||(a[0]=e=>d.value=e),f],loading:(0,i.SU)(c),options:(0,i.SU)(m)},null,8,["value","loading","options"])]),(0,i._)("div",u,[(0,i.Wm)(s,{value:t.value,"onUpdate:value":[a[1]||(a[1]=e=>t.value=e),g],loading:(0,i.SU)(c),options:(0,i.SU)(v),filterable:!0},null,8,["value","loading","options"])])],64)}}})},72227:function(e,t,a){a.d(t,{Z:()=>n});var l=a(46126),i=a(25595),s=a(43407),r=a(81208);let n=(0,i.aZ)({__name:"TemplateSelect",props:{value:{},valueModifiers:{},content:{},contentModifiers:{}},emits:(0,i.Vf)(["listReady"],["update:value","update:content"]),setup(e,t){let{emit:a}=t,n=(0,i.tT)(e,"value"),o=(0,i.tT)(e,"content"),u=(0,i.iH)(!1),c=(0,i.iH)([]),d=(e,t)=>{let{data:a}=t;(0,s.Kn)(a)&&(o.value=a.html_content)};return(async()=>{try{u.value=!0;let e=await (0,r.NI)();if((0,s.kJ)(e)){if(c.value=e.map(e=>({label:e.temp_name,value:e.id,data:e})),null===n.value)n.value=e[0].id,o.value=e[0].html_content;else{let t=e.find(e=>e.id===n.value);t&&(o.value=t.html_content)}a("listReady",e)}}finally{u.value=!1}})(),(e,t)=>{let a=l.Z;return(0,i.wg)(),(0,i.j4)(a,{value:n.value,"onUpdate:value":[t[0]||(t[0]=e=>n.value=e),d],loading:(0,i.SU)(u),filterable:!0,options:(0,i.SU)(c)},null,8,["value","loading","options"])}}})},33278:function(e,t,a){a.r(t),a.d(t,{default:()=>ec});var l=a(59147),i=a(21921),s=a(90767),r=a(64657),n=a(67905),o=a(79380),u=a(86581),c=a(29403),d=a(99833),m=a(85068),p=a(34909),v=a(91132),f=a(89667),g=a(25595),b=a(86695),k=a(267),h=a(43407),_=a(26973),w=a(66844),U=a(46126),S=a(16821),y=a(20969),x=a(41074),Z=a(73217),W=a(48812),j=a(23865);let O={class:"pt-12px"},M={class:"flex-1"},C={class:"mt-8px text-12px text-desc"},z=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,$=(0,g.aZ)({__name:"CreateGroup",setup(e){let{t}=(0,j.QT)(),a=(0,g.AE)("formRef"),l=(0,g.qj)({create_type:2,name:"",file_data:"",file_type:"",description:"",status:1}),s={name:{required:!0,message:t("market.task.createGroup.validation.groupNameRequired"),trigger:["blur","input"]}},r=[{label:"Confirmed",value:1},{label:"Unconfirmed",value:0}],n=e=>{let t=new FileReader;t.onload=t=>{var a;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(a=t.target)?void 0:a.result},e.file&&t.readAsText(e.file)},o=async()=>{await (0,W.Sv)({file_path:"./template/example_recipients.csv"})},u=async()=>{var e;if(await (null==(e=a.value)?void 0:e.validate()),(0,Z.Z)(l.file_data))return h.v0.error(t("contacts.subscribers.import.validation.fileRequired")),Promise.reject()},[c,v]=(0,S.d)({onChangeState:e=>{e&&(l.name="",l.file_data="",l.file_type="")},onConfirm:async()=>{await u(),await (0,y.sS)((0,g.IU)(l));let e=v.getState();null==e||e.refresh()}});return(e,u)=>{let v=m.Z,f=p.ZP,b=U.Z,k=x.Z,h=d.ZP,_=i.Z;return(0,g.wg)(),(0,g.j4)((0,g.SU)(c),{title:(0,g.SU)(t)("market.task.createGroup.title"),width:"500"},{default:(0,g.w5)(()=>[(0,g._)("div",O,[(0,g.Wm)(_,{ref_key:"formRef",ref:a,model:(0,g.SU)(l),rules:s},{default:(0,g.w5)(()=>[(0,g.Wm)(f,{label:(0,g.SU)(t)("market.task.createGroup.groupName"),path:"name"},{default:(0,g.w5)(()=>[(0,g.Wm)(v,{value:(0,g.SU)(l).name,"onUpdate:value":u[0]||(u[0]=e=>(0,g.SU)(l).name=e),placeholder:(0,g.SU)(t)("market.task.createGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,g.Wm)(f,{label:"Status"},{default:(0,g.w5)(()=>[(0,g.Wm)(b,{value:(0,g.SU)(l).status,"onUpdate:value":u[1]||(u[1]=e=>(0,g.SU)(l).status=e),options:r},null,8,["value"])]),_:1}),(0,g.Wm)(f,{label:(0,g.SU)(t)("market.task.createGroup.email"),path:"file_data"},{default:(0,g.w5)(()=>[(0,g._)("div",M,[(0,g.Wm)(k,{"is-upload":!1,accept:["csv"],onChange:n}),(0,g._)("div",C,[(0,g.Uk)((0,g.zw)(e.$t("contacts.subscribers.import.fileTypeHint"))+" ",1),(0,g.Wm)(h,{text:"",type:"primary",onClick:o},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("common.actions.download")),1)]),_:1})])])]),_:1},8,["label"]),(0,g.Wm)(f,{label:e.$t("contacts.subscribers.import.exampleCsvLabel")},{default:(0,g.w5)(()=>[(0,g._)("pre",{class:"csv-example"},(0,g.zw)(z))]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var T=a(83744);let P=(0,T.default)($,[["__scopeId","data-v-49081638"]]),R={class:"flex-1"},E={class:"flex items-center"},q={class:"flex-1"},H={class:"ml-12px"},D=(0,g.aZ)({__name:"GroupSelect",props:{value:{default:()=>[]},valueModifiers:{},label:{default:()=>[]},labelModifiers:{}},emits:["update:value","update:label"],setup(e){let t=(0,g.tT)(e,"value"),a=(0,g.tT)(e,"label"),l=(0,g.iH)(!1),i=(0,g.iH)([]),s=(0,g.iH)(0),[r,n]=(0,S.d)({component:P,state:{refresh:()=>{c()}}}),o=()=>{n.open()},u=async e=>{if(a.value=e.map(e=>{let t=i.value.find(t=>t.value===e);return`${(null==t?void 0:t.label)||""}`}),0===e.length){s.value=0;return}let t=await (0,y.vi)({group_ids:e});(0,h.Kn)(t)&&(s.value=t.total)},c=async()=>{try{l.value=!0;let e=await (0,y.WH)();(0,h.Kn)(e)&&(i.value=e.list.map(e=>({label:e.name,value:e.id})))}finally{l.value=!1}};return c(),(e,a)=>{let n=U.Z,c=d.ZP,m=(0,g.up)("i18n-t");return(0,g.wg)(),(0,g.iD)("div",R,[(0,g._)("div",E,[(0,g._)("div",q,[(0,g.Wm)(n,{value:t.value,"onUpdate:value":[a[0]||(a[0]=e=>t.value=e),u],options:(0,g.SU)(i),multiple:!0,filterable:!0,"max-tag-count":"responsive",loading:(0,g.SU)(l),placeholder:e.$t("market.task.edit.recipientsPlaceholder")},null,8,["value","options","loading","placeholder"])]),(0,g._)("div",H,[(0,g.Wm)(c,{text:"",type:"primary",onClick:o},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("common.actions.create")),1)]),_:1})])]),(0,g.Wm)(m,{class:"mt-8px",tag:"div",scope:"global",keypath:"market.task.edit.recipientsCount"},{count:(0,g.w5)(()=>[(0,g._)("b",null,(0,g.zw)((0,g.SU)(s)),1)]),_:1}),(0,g.Wm)((0,g.SU)(r))])}}});var G=a(72227),B=a(29938);let F={class:"task-edit-container"},L={class:"flex flex-col flex-1 p-24px overflow-auto"},N={class:"flex-1"},I={class:"ml-12px text-desc"},K={class:"w-60px"},X={class:"flex-1 mr-10px"},A={class:"task-preview"},V={class:"preview-header"},J={class:"preview-header-item"},Q={class:"preview-label"},Y={class:"preview-value"},ee={class:"preview-header-item"},et={class:"preview-label"},ea={class:"preview-value"},el={class:"preview-header-item"},ei={class:"preview-label"},es={class:"preview-value"},er={class:"preview-content"},en={key:1,class:"empty-preview"},eo={class:"action-buttons"},eu=(0,g.aZ)({__name:"edit",setup(e){let{t}=(0,j.QT)(),a=(0,b.s6)(),U=(0,B.tv)(),S=(0,B.yj)(),y=(0,g.AE)("formRef"),x=(0,g.AE)("formContentRef"),{height:Z}=(0,k.rBN)(x),W=(0,g.qj)({addresser:null,full_name:"",subject:"",group_ids:[],template_id:null,is_record:1,unsubscribe:1,warmup:0,threads:0,start_time:null,remark:""}),O={full_name:{trigger:["blur","input"],validator:()=>""!==W.full_name||Error(t("market.task.edit.validation.displayNameRequired"))},subject:{trigger:["blur","input"],validator:()=>""!==W.subject||Error(t("market.task.edit.validation.subjectRequired"))},group_ids:{trigger:"change",validator:()=>0!==W.group_ids.length||Error(t("market.task.edit.validation.recipientsRequired"))},template_id:{trigger:"change",validator:()=>null!==W.template_id||Error(t("market.task.edit.validation.templateRequired"))},start_time:{validator:()=>1!==z.value||null!==W.start_time||Error(t("market.task.edit.validation.sendTimeRequired"))}},M=(0,g.iH)([]),C=(0,g.iH)(0),z=(0,g.iH)(0),$=(0,g.iH)(""),T=(0,g.iH)(""),P=()=>{U.push("/template")},R=e=>{0===e?W.threads=0:W.threads=5},E=()=>{0===z.value&&(W.start_time=null)},q=async()=>$.value?W.subject?W.template_id?void await (0,_.jC)({addresser:W.addresser||"",subject:W.subject,recipient:$.value,template_id:W.template_id||0}):void h.v0.error(t("market.task.edit.validation.templateRequired")):void h.v0.error(t("market.task.edit.validation.subjectRequired")):void h.v0.error(t("market.task.edit.validation.testEmailRequired")),H=()=>{W.subject||W.group_ids.length>0?(0,h.iG)({title:t("market.task.edit.discard.title"),content:t("market.task.edit.discard.content"),onConfirm:()=>{U.go(-1)}}):U.go(-1)},eu=()=>{let e=W.start_time;return(0===z.value||null===e)&&(e=Date.now()),{track_open:1,track_click:1,addresser:W.addresser||"",full_name:W.full_name,subject:W.subject,group_ids:W.group_ids,template_id:W.template_id||0,is_record:W.is_record,unsubscribe:W.unsubscribe,warmup:W.warmup,threads:W.threads,start_time:e/1e3,remark:W.remark}},ec=async()=>{var e;await (null==(e=y.value)?void 0:e.validate()),await (0,_.gI)(eu()),U.push("/market/task")};function ed(e){if(S.query.chat_id){let t=e.find(e=>e.chat_id==S.query.chat_id);t&&(W.template_id=t.id,W.subject=a.temp_subject,T.value=t.html_content)}}return(e,a)=>{let b=(0,g.up)("router-link"),k=f.Z,h=v.ZP,_=p.ZP,U=m.Z,S=d.ZP,j=c.Z,B=u.Z,eu=o.Z,em=n.Z,ep=r.ZP,ev=s.Z,ef=i.Z,eg=l.Z;return(0,g.wg)(),(0,g.iD)("div",F,[(0,g._)("div",L,[(0,g.Wm)(h,{class:"mb-20px"},{default:(0,g.w5)(()=>[(0,g.Wm)(k,null,{default:(0,g.w5)(()=>[(0,g.Wm)(b,{to:"/market/task"},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("market.task.title")),1)]),_:1})]),_:1}),(0,g.Wm)(k,null,{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("market.task.edit.addTitle")),1)]),_:1})]),_:1}),(0,g._)("div",{class:"task-edit-box",style:(0,g.j5)({minHeight:(0,g.SU)(Z)+"px"})},[(0,g.Wm)(ef,{ref_key:"formRef",ref:y,class:"task-edit-form",model:(0,g.SU)(W),rules:O},{default:(0,g.w5)(()=>[(0,g._)("div",{ref_key:"formContentRef",ref:x},[(0,g.Wm)(ep,{class:"mb-24px"},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{label:e.$t("market.task.edit.from")},{default:(0,g.w5)(()=>[(0,g.Wm)(w.Z,{value:(0,g.SU)(W).addresser,"onUpdate:value":a[0]||(a[0]=e=>(0,g.SU)(W).addresser=e),name:(0,g.SU)(W).full_name,"onUpdate:name":a[1]||(a[1]=e=>(0,g.SU)(W).full_name=e)},null,8,["value","name"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.displayName"),path:"full_name"},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:(0,g.SU)(W).full_name,"onUpdate:value":a[2]||(a[2]=e=>(0,g.SU)(W).full_name=e),placeholder:e.$t("market.task.edit.displayNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.subject"),path:"subject"},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:(0,g.SU)(W).subject,"onUpdate:value":a[3]||(a[3]=e=>(0,g.SU)(W).subject=e),placeholder:e.$t("market.task.edit.subjectPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.recipients"),type:"group_ids"},{default:(0,g.w5)(()=>[(0,g.Wm)(D,{value:(0,g.SU)(W).group_ids,"onUpdate:value":a[4]||(a[4]=e=>(0,g.SU)(W).group_ids=e),label:(0,g.SU)(M),"onUpdate:label":a[5]||(a[5]=e=>(0,g.dq)(M)?M.value=e:null)},null,8,["value","label"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.template"),path:"template_id"},{default:(0,g.w5)(()=>[(0,g._)("div",N,[(0,g.Wm)(G.Z,{value:(0,g.SU)(W).template_id,"onUpdate:value":a[6]||(a[6]=e=>(0,g.SU)(W).template_id=e),content:(0,g.SU)(T),"onUpdate:content":a[7]||(a[7]=e=>(0,g.dq)(T)?T.value=e:null),onListReady:ed},null,8,["value","content"])]),(0,g.Wm)(S,{text:"",type:"primary",class:"ml-12px",onClick:P},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)((0,g.SU)(t)("common.actions.create")),1)]),_:1})]),_:1},8,["label"]),(0,g.kq)("",!0),(0,g.Wm)(_,{label:(0,g.SU)(t)("market.task.edit.ipWarmup")},{default:(0,g.w5)(()=>[(0,g.Wm)(j,{value:(0,g.SU)(W).warmup,"onUpdate:value":a[9]||(a[9]=e=>(0,g.SU)(W).warmup=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),(0,g._)("span",I,(0,g.zw)((0,g.SU)(t)("market.task.edit.ipWarmupTip")),1)]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.unsubscribeLink")},{default:(0,g.w5)(()=>[(0,g.Wm)(j,{value:(0,g.SU)(W).unsubscribe,"onUpdate:value":a[10]||(a[10]=e=>(0,g.SU)(W).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.threads"),"show-feedback":!1},{default:(0,g.w5)(()=>[(0,g.Wm)(eu,{value:(0,g.SU)(C),"onUpdate:value":[a[11]||(a[11]=e=>(0,g.dq)(C)?C.value=e:null),R]},{default:(0,g.w5)(()=>[(0,g.Wm)(B,{value:0},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("market.task.edit.threadsAuto")),1)]),_:1}),(0,g.Wm)(B,{value:1},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("market.task.edit.threadsCustom")),1)]),_:1})]),_:1},8,["value"]),(0,g.wy)((0,g._)("div",K,[(0,g.Wm)(em,{value:(0,g.SU)(W).threads,"onUpdate:value":a[12]||(a[12]=e=>(0,g.SU)(W).threads=e),min:1,max:100,"show-button":!1},null,8,["value"])],512),[[g.F8,1===(0,g.SU)(C)]])]),_:1},8,["label"])]),_:1}),(0,g.Wm)(ep,null,{default:(0,g.w5)(()=>[(0,g.Wm)(_,{label:(0,g.SU)(t)("market.task.edit.sendTime"),path:"start_time"},{default:(0,g.w5)(()=>[(0,g.Wm)(eu,{value:(0,g.SU)(z),"onUpdate:value":[a[14]||(a[14]=e=>(0,g.dq)(z)?z.value=e:null),E],class:"flex items-center"},{default:(0,g.w5)(()=>[(0,g.Wm)(B,{value:0},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)((0,g.SU)(t)("market.task.edit.sendTimeNow")),1)]),_:1}),(0,g.Wm)(B,{class:"items-center",value:1}),(0,g.Wm)(ev,{value:(0,g.SU)(W).start_time,"onUpdate:value":a[13]||(a[13]=e=>(0,g.SU)(W).start_time=e),class:"ml-8px",type:"datetime",disabled:0===(0,g.SU)(z)},null,8,["value","disabled"])]),_:1},8,["value"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.remark")},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:(0,g.SU)(W).remark,"onUpdate:value":a[15]||(a[15]=e=>(0,g.SU)(W).remark=e),placeholder:e.$t("market.task.edit.remarkPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,g.Wm)(_,{label:e.$t("market.task.edit.testEmail"),"show-feedback":!1},{default:(0,g.w5)(()=>[(0,g._)("div",X,[(0,g.Wm)(U,{value:(0,g.SU)($),"onUpdate:value":a[16]||(a[16]=e=>(0,g.dq)($)?$.value=e:null),placeholder:e.$t("market.task.edit.testEmailPlaceholder")},null,8,["value","placeholder"])]),(0,g.Wm)(S,{onClick:q},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("market.task.edit.sendTest")),1)]),_:1})]),_:1},8,["label"])]),_:1})],512)]),_:1},8,["model"]),(0,g._)("div",A,[(0,g.Wm)(ep,{class:"h-full","content-style":{display:"flex",flexDirection:"column",height:"100%"}},{default:(0,g.w5)(()=>[(0,g._)("div",V,[(0,g._)("div",J,[(0,g._)("div",Q,(0,g.zw)((0,g.SU)(t)("market.task.edit.from"))+":",1),(0,g._)("div",Y,(0,g.zw)((0,g.SU)(W).addresser),1)]),(0,g._)("div",ee,[(0,g._)("div",et,(0,g.zw)((0,g.SU)(t)("market.task.edit.to"))+":",1),(0,g._)("div",ea,(0,g.zw)((0,g.SU)(M).length>0?(0,g.SU)(M).join(", "):"--"),1)]),(0,g._)("div",el,[(0,g._)("div",ei,(0,g.zw)((0,g.SU)(t)("market.task.edit.subject"))+":",1),(0,g._)("div",es,(0,g.zw)((0,g.SU)(W).subject||"--"),1)])]),(0,g._)("div",er,[(0,g.SU)(T)?((0,g.wg)(),(0,g.j4)(eg,{key:0,value:(0,g.SU)(T)},null,8,["value"])):((0,g.wg)(),(0,g.iD)("div",en,(0,g.zw)((0,g.SU)(t)("market.task.edit.preview.empty")),1))])]),_:1})])],4)]),(0,g._)("div",eo,[(0,g.Wm)(S,{type:"primary",onClick:ec},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("common.actions.confirm")),1)]),_:1}),(0,g.Wm)(S,{class:"ml-16px",secondary:"",onClick:H},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.$t("common.actions.back")),1)]),_:1})])])}}}),ec=(0,T.default)(eu,[["__scopeId","data-v-5ec96514"]])}}]);