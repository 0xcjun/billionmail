"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["5638"],{77596:function(e,t,l){l.d(t,{Z:()=>r});var a=l(25595),i=l(23295);let n=Object.assign(Object.assign({},l(51045).Z.props),{trigger:String,xScrollable:Boolean,onScroll:Function,contentClass:String,contentStyle:[Object,String],size:Number,yPlacement:{type:String,default:"right"},xPlacement:{type:String,default:"bottom"}}),r=(0,a.aZ)({name:"Scrollbar",props:n,setup(){let e=(0,a.iH)(null);return Object.assign(Object.assign({},{scrollTo:(...t)=>{var l;null==(l=e.value)||l.scrollTo(t[0],t[1])},scrollBy:(...t)=>{var l;null==(l=e.value)||l.scrollBy(t[0],t[1])}}),{scrollbarInstRef:e})},render(){return(0,a.h)(i.Z,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}})},69288:function(e,t,l){l.d(t,{Ew:()=>s,I5:()=>d,JI:()=>f,L3:()=>o,Nh:()=>h,WJ:()=>v,nn:()=>g});var a=l(86244),i=l(25595);let n={fetchOptions:{loading:"Loading... Please wait.",successMessage:!0}};async function r(e,t){try{await a.e.post("/email_template/create",{temp_name:t,add_type:2,chat_id:e,html_content:""})}catch(e){throw console.warn(e),e}}async function o(e){await c(e),await u(e)}async function s(e){try{let t=`AI_temp_${new Date().getTime()}`,l=await a.e.post("/askai/chat/create_chat",{domain:e,add_type:99,temp_name:t},n);return await r(l.chatId,t),l.chatId}catch(e){return console.warn(e),null}}async function c(e){let{modelList:t,currentModel:l,currentModelTitle:i}=e;try{t.value=await a.e.post("/askai/supplier/models"),t.value.length&&(l.value=t.value[0],i.value=t.value[0].title)}catch(e){console.warn(e)}}async function u(e){let{chatId:t,chatInfo:l,currentModel:i,modelList:n,currentModelTitle:r,chatRecord:o}=e;try{if(l.value=await a.e.post("/askai/chat/info",{chatId:t.value}),l.value.modelId&&n.value.length){let e=n.value.find(e=>e.modelId==l.value.modelId);e&&(i.value=e,r.value=e.title)}for(let e=0;e<l.value.messages.length;e++)"user"==l.value.messages[e].role&&o.value.set(`${l.value.messages[e].content}_+_${o.value.size}`,p(l.value.messages[e+1].content))}catch(e){console.warn(e)}}async function d(e){let{chatId:t,isChat:l}=e;try{await a.e.post("/askai/chat/stop",{chatId:t.value},n),l.value=!1}catch(e){console.warn(e)}}async function v(e){let{scrollable:t,generateShow:l,chatId:n,currentModel:r,questionContent:o,chatRecord:s,currentChatRecordKey:c,scrollWrapperRef:u,chatScrollRef:d,isChat:v}=e,f=`${o.value}_+_${s.value.size}`;s.value.set(f,[]),c.value=f;let h=o.value;o.value="";let g=[],m="",y=0;try{t.value=!0,l.value=!0,v.value=!0,(0,i.Y3)(()=>d.value.scrollTo({left:0,top:u.value.offsetHeight})),await a.e.post("/askai/chat/chat",{chatId:n.value,supplierName:r.value.supplierName,modelId:r.value.modelId,content:h,is_text:"false"},{fetchOptions:{cancelResInterceptor:!0},responseType:"text",onDownloadProgress:e=>{l.value=!1;try{let l=e.event.target.responseText,i=l.slice(y);y=l.length;var a=function(e){let t=e.split("\n"),l=[];for(let e of t){let t=e.trim();if(t.startsWith("data:")){let e=t.slice(5).trim();e&&l.push(e)}}return l}(i);for(let e=0;e<a.length;e++)a[e]&&(m+=JSON.parse(a[e]).content);s.value.set(f,p(m)),t.value&&setTimeout(()=>d.value.scrollTo({left:0,top:u.value.offsetHeight}),200)}catch(e){console.warn(e)}}}),t.value=!0,d.value.scrollTo({left:0,top:u.value.offsetHeight}),v.value=!1}catch(e){console.warn(e)}finally{l.value=!1,m="",y=0}}function p(e){let t=/```[\s\S]*?(?:```|$)/g,l=e.match(t)||[],a=e.split(t),i=[],n=Math.max(a.length,l.length);for(let e=0;e<n;e++)e<a.length&&""!==a[e].trim()&&i.push(a[e]),e<l.length&&i.push(l[e]);return i}function f(e){return e.replace(/```html/g,"").replace(/```$/gm,"")}async function h(e){let{chatId:t,previewCode:l}=e;try{l.value=await a.e.post("/askai/chat/get_html",{chatId:t.value})}catch(e){console.warn(e)}}async function g(e){let{previewCode:t,chatId:l}=e;try{await a.e.post("/askai/chat/modify_html",{chatId:l.value,content:t.value},n)}catch(e){console.warn(e)}}},66560:function(e,t,l){l.d(t,{Z:()=>o});var a=l(20993),i=l(25595),n=l(53217);let r=(0,i.aZ)({__name:"index",props:(0,i.Vf)({language:{type:String,default:"html"},theme:{type:String,default:"vs-dark"},options:{type:Object,default:()=>({})}},{value:{default:""},valueModifiers:{}}),emits:(0,i.Vf)(["save"],["update:value"]),setup(e,t){let{expose:l,emit:r}=t,o=(0,i.tT)(e,"value"),s=(0,i.iH)(null),c=null,u=(0,i.iH)(!1);n.Z.config({paths:{vs:`${location.origin}/static/plugin/monaco`}});let d=async()=>{if(s.value&&!c)try{u.value=!0;let t=await n.Z.init();(c=t.editor.create(s.value,{value:o.value,language:e.language,theme:e.theme,minimap:{enabled:!1},automaticLayout:!0,scrollBeyondLastLine:!1,fontSize:14,tabSize:2,wordWrap:"on",...e.options})).onDidChangeModelContent(()=>{o.value=(null==c?void 0:c.getValue())||""}),c.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyS,function(){r("save")})}finally{u.value=!1}},v=()=>{c&&(c.dispose(),c=null)};return(0,i.YP)(()=>o.value,e=>{c&&e!==c.getValue()&&c.setValue(e)}),(0,i.bv)(()=>{d()}),(0,i.Jd)(()=>{v()}),l({getEditor:()=>c}),(e,t)=>{let l=a.Z;return(0,i.wg)(),(0,i.j4)(l,{class:"h-full",show:(0,i.SU)(u)},{default:(0,i.w5)(()=>[(0,i._)("div",{ref_key:"containerRef",ref:s,class:"monaco-editor-container"},null,512)]),_:1},8,["show"])}}}),o=(0,l(83744).default)(r,[["__scopeId","data-v-72ffe419"]])},4485:function(e,t,l){l.r(t),l.d(t,{default:()=>Q});var a=l(25595),i=l(87209),n=l(48482),r=l(96558),o=l(35577),s=l(49858);let c="0!important",u="-1px!important";function d(e){return(0,s.cM)(`${e}-type`,[(0,s.c)("& +",[(0,s.cB)("button",{},[(0,s.cM)(`${e}-type`,[(0,s.cE)("border",{borderLeftWidth:c}),(0,s.cE)("state-border",{left:u})])])])])}function v(e){return(0,s.cM)(`${e}-type`,[(0,s.c)("& +",[(0,s.cB)("button",[(0,s.cM)(`${e}-type`,[(0,s.cE)("border",{borderTopWidth:c}),(0,s.cE)("state-border",{top:u})])])])])}let p=(0,s.cB)("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[(0,s.u4)("vertical",{flexDirection:"row"},[(0,s.u4)("rtl",[(0,s.cB)("button",[(0,s.c)("&:first-child:not(:last-child)",`
 margin-right: ${c};
 border-top-right-radius: ${c};
 border-bottom-right-radius: ${c};
 `),(0,s.c)("&:last-child:not(:first-child)",`
 margin-left: ${c};
 border-top-left-radius: ${c};
 border-bottom-left-radius: ${c};
 `),(0,s.c)("&:not(:first-child):not(:last-child)",`
 margin-left: ${c};
 margin-right: ${c};
 border-radius: ${c};
 `),d("default"),(0,s.cM)("ghost",[d("primary"),d("info"),d("success"),d("warning"),d("error")])])])]),(0,s.cM)("vertical",{flexDirection:"column"},[(0,s.cB)("button",[(0,s.c)("&:first-child:not(:last-child)",`
 margin-bottom: ${c};
 margin-left: ${c};
 margin-right: ${c};
 border-bottom-left-radius: ${c};
 border-bottom-right-radius: ${c};
 `),(0,s.c)("&:last-child:not(:first-child)",`
 margin-top: ${c};
 margin-left: ${c};
 margin-right: ${c};
 border-top-left-radius: ${c};
 border-top-right-radius: ${c};
 `),(0,s.c)("&:not(:first-child):not(:last-child)",`
 margin: ${c};
 border-radius: ${c};
 `),v("default"),(0,s.cM)("ghost",[v("primary"),v("info"),v("success"),v("warning"),v("error")])])])]),f=(0,a.aZ)({name:"ButtonGroup",props:{size:{type:String,default:void 0},vertical:Boolean},setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:l}=(0,i.ZP)(e);return(0,n.Z)("-button-group",p,t),(0,a.JJ)(o.J,e),{rtlEnabled:(0,r.V)("ButtonGroup",l,t),mergedClsPrefix:t}},render(){let{mergedClsPrefix:e}=this;return(0,a.h)("div",{class:[`${e}-button-group`,this.rtlEnabled&&`${e}-button-group--rtl`,this.vertical&&`${e}-button-group--vertical`],role:"group"},this.$slots)}});var h=l(99833),g=l(85068),m=l(77596),y=l(64657),_=l(46126),w=l(69288),b=l(29121),k=l(82183),S=l(267);let x={key:0,class:"code-area"},$={class:"code-tool"},H={class:"tools"},I=["innerHTML"],U=["innerHTML"],Z=(0,a.aZ)({__name:"MarkdownRender",props:{content:{},chatRecordKey:{}},emits:["codeRender"],setup(e,t){let{emit:l}=t,{copy:i,copied:n}=(0,S.VPI)(),{currentChatRecordKey:r,previewCode:o}=(0,a.f3)("modelStore"),s=(0,a.iH)(),c=(0,a.iH)(""),u=(0,a.iH)(""),d=(0,b.Z)({html:!0,linkify:!0,typographer:!0,langPrefix:"language-",highlight:function(e,t){if(c.value=t,t&&k.Z.getLanguage(t))try{return k.Z.highlight(t,e).value}catch{}return d.utils.escapeHtml(e)}});function v(){r.value=e.chatRecordKey,(0,a.Y3)(()=>o.value=(0,w.JI)(e.content))}function p(){i(e.content)}return u.value=d.render(e.content),(0,a.YP)(()=>e.content,t=>{u.value=d.render(t),c.value&&l("codeRender",{code:e.content,key:e.chatRecordKey})}),(e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.SU)(c)?((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("div",$,[(0,a._)("span",null,(0,a.zw)((0,a.SU)(c)),1),(0,a._)("div",H,[(0,a._)("div",{class:"tool-item",onClick:p},[t[0]||(t[0]=(0,a._)("i",{class:"i-material-symbols:chrome-restore-rounded text-5"},null,-1)),(0,a._)("span",null,(0,a.zw)((0,a.SU)(n)?"Copied":"Copy"),1)]),(0,a._)("div",{class:"tool-item",onClick:v},t[1]||(t[1]=[(0,a._)("i",{class:"i-mingcute:eye-2-fill text-5"},null,-1),(0,a._)("span",null,"View",-1)]))])]),(0,a._)("div",{innerHTML:(0,a.SU)(u)},null,8,I)])):((0,a.wg)(),(0,a.iD)("div",{key:1,ref_key:"codeRef",ref:s,innerHTML:(0,a.SU)(u)},null,8,U))]))}});var C=l(83744);let W=(0,C.default)(Z,[["__scopeId","data-v-03e44d0d"]]);var M=l(66560),T=l(29938);let D={class:"wrapper"},R={class:"ai-container"},J={class:"chat-area"},L={class:"model-select"},j={class:"flex justify-start items-center gap-15px"},B={class:"ask-content"},P={class:"text"},z={class:"answer-content"},E={class:"text"},O=["onClick"],K={class:"question"},V={class:"send-btn"},N={class:"view-area"},Y={style:{height:"calc(100vh - 177px)"}},q={class:"h-10 flex justify-start items-center gap-2.5"},A={key:0},G=["innerHTML"],F=(0,a.aZ)({__name:"index",setup(e){let t=function(){let e=(0,a.iH)([]),t=(0,a.iH)(""),l=(0,a.iH)(""),i=(0,a.iH)(""),n=(0,a.iH)({chatId:"",create_time:0,files:[],messages:[],modelId:"",prompt:"",supplierName:"",title:"",update_time:0}),r=(0,a.iH)(""),o=(0,a.iH)([]),s=(0,a.iH)({modelId:"",supplierName:"",capability:[],title:"",status:!1,max_tokens:0}),c=(0,a.iH)(""),u=(0,a.iH)([]),d=(0,a.iH)(""),v=(0,a.iH)(!1),p=(0,a.iH)(new Map),f=(0,a.iH)(!1),h=(0,a.iH)();return{domainList:e,sourceDomain:t,chatId:l,questionContent:i,chatInfo:n,currentChatRecordKey:r,modelList:o,currentModel:s,currentModelTitle:c,answerContent:u,previewCode:d,generateShow:v,chatRecord:p,isChat:f,chatScrollRef:h,scrollWrapperRef:(0,a.iH)(),scrollable:(0,a.iH)(!0)}}();(0,a.JJ)("modelStore",t);let{chatId:l,modelList:i,currentModelTitle:n,previewCode:r,questionContent:o,chatRecord:s,currentChatRecordKey:c,currentModel:u,isChat:d,chatScrollRef:v,scrollWrapperRef:p,scrollable:b}=t,k=(0,T.yj)(),S=(0,a.iH)("view");function x(e,t){u.value=t}function $(e){e.key==c.value&&(r.value=(0,w.JI)(e.code))}function H(e){e.deltaY<0&&(b.value=!1)}return l.value=k.params.chatId,(0,w.Nh)(t),(0,w.L3)(t),(0,a.bv)(()=>{!function e(t){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t||null,i=l;if(!(i>=6)){if(a&&(clearTimeout(t),a=null),p.value.offsetHeight){v.value.scrollTo({left:0,top:p.value.offsetHeight}),i++;return}i++,a=setTimeout(()=>{e(a,i)},100)}}()}),(e,l)=>{let c=_.Z,u=y.ZP,b=m.Z,k=g.Z,I=h.ZP;return(0,a.wg)(),(0,a.iD)("div",D,[l[15]||(l[15]=(0,a.uE)('<div class="page-tit" data-v-a61e5c3c><div class="back-tool" data-v-a61e5c3c><i class="i-ci:arrow-left-lg text-4" data-v-a61e5c3c></i><div class="back-btn" data-v-a61e5c3c>back</div></div><span class="tit-content" data-v-a61e5c3c> AI Template </span></div>',1)),(0,a._)("div",R,[(0,a._)("div",J,[(0,a._)("div",L,[(0,a.Wm)(u,null,{default:(0,a.w5)(()=>[(0,a._)("div",j,[(0,a.Wm)(c,{value:(0,a.SU)(n),"onUpdate:value":[l[0]||(l[0]=e=>(0,a.dq)(n)?n.value=e:null),x],class:"flex-1",options:(0,a.SU)(i),"label-field":"title","value-field":"title"},null,8,["value","options"])])]),_:1})]),(0,a._)("div",{ref:"answerRef",class:"answer",onWheel:H},[(0,a.Wm)(u,{class:"h-100%"},{default:(0,a.w5)(()=>[(0,a.Wm)(b,{ref_key:"chatScrollRef",ref:v,style:{height:"calc(100vh - 522px)"}},{default:(0,a.w5)(()=>[(0,a._)("div",{ref_key:"scrollWrapperRef",ref:p},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,a.SU)(s),e=>((0,a.wg)(),(0,a.iD)("div",{key:e[0],class:"answer-container"},[(0,a._)("div",B,[l[8]||(l[8]=(0,a._)("div",{class:"pic"},[(0,a._)("i",{class:"i-material-symbols:account-circle text-6 text-[var(--color-primary-hover-1)]"})],-1)),(0,a._)("div",P,(0,a.zw)(e[0].split("_+_")[0]),1)]),(0,a._)("div",z,[l[10]||(l[10]=(0,a._)("div",{class:"pic"},[(0,a._)("span",{class:"text-4 text-[var(--color-primary-hover-1)]"},"BillionMail")],-1)),(0,a._)("div",E,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e[1],(t,l)=>((0,a.wg)(),(0,a.j4)(W,{key:l,content:t,"chat-record-key":e[0],class:"mb-4",onCodeRender:$},null,8,["content","chat-record-key"]))),128))]),(0,a._)("div",{class:"answer-tool",onClick:l=>{o.value=e[0].toString().split("_+_")[0],(0,w.WJ)(t)}},l[9]||(l[9]=[(0,a._)("div",{class:"tool-item"},[(0,a._)("i",{class:"i-ri:refresh-line text-5"}),(0,a._)("span",null,"Regenerate")],-1),(0,a._)("div",{class:"tool-item"},[(0,a._)("i",{class:"i-ri:information-2-fill text-5"}),(0,a._)("span",null,"Info")],-1)]),8,O)])]))),128))],512)]),_:1},512)]),_:1})],544),(0,a._)("div",K,[(0,a.Wm)(u,{style:{height:"100%"}},{default:(0,a.w5)(()=>[(0,a.Wm)(k,{value:(0,a.SU)(o),"onUpdate:value":l[1]||(l[1]=e=>(0,a.dq)(o)?o.value=e:null),type:"textarea",class:"question-input",onKeydown:l[2]||(l[2]=(0,a.D2)(e=>(0,a.SU)(w.WJ)((0,a.SU)(t)),["enter"]))},null,8,["value"]),(0,a._)("div",V,[(0,a.SU)(d)?((0,a.wg)(),(0,a.iD)("i",{key:1,class:"i-svg-spinners:pulse-2 text-8 text-[var(--color-primary-1)] hover-text-[var(--color-primary-hover-1)]",onClick:l[4]||(l[4]=e=>(0,a.SU)(w.I5)((0,a.SU)(t)))})):((0,a.wg)(),(0,a.iD)("i",{key:0,class:"i-icon-park-twotone:arrow-circle-up text-8 text-[var(--color-primary-1)] hover-text-[var(--color-primary-hover-1)]",onClick:l[3]||(l[3]=e=>(0,a.SU)(w.WJ)((0,a.SU)(t)))}))])]),_:1})])]),(0,a._)("div",N,[(0,a.Wm)(u,{style:{height:"100%"}},{default:(0,a.w5)(()=>[(0,a._)("div",Y,[(0,a._)("div",q,[(0,a.Wm)(f,{size:"small"},{default:(0,a.w5)(()=>[(0,a.Wm)(I,{type:"view"==(0,a.SU)(S)?"primary":"default",onClick:l[5]||(l[5]=e=>S.value="view")},{icon:(0,a.w5)(()=>l[11]||(l[11]=[(0,a._)("i",{class:"i-mingcute:eye-2-fill text-5"},null,-1)])),default:(0,a.w5)(()=>[l[12]||(l[12]=(0,a.Uk)(" View "))]),_:1,__:[12]},8,["type"]),(0,a.Wm)(I,{type:"edit"==(0,a.SU)(S)?"primary":"default",onClick:l[6]||(l[6]=e=>S.value="edit")},{icon:(0,a.w5)(()=>l[13]||(l[13]=[(0,a._)("i",{class:"i-tdesign:code text-5"},null,-1)])),default:(0,a.w5)(()=>[l[14]||(l[14]=(0,a.Uk)(" Edit "))]),_:1,__:[14]},8,["type"])]),_:1}),"edit"==(0,a.SU)(S)?((0,a.wg)(),(0,a.iD)("span",A,"[Ctrl + s] to save your change")):(0,a.kq)("",!0)]),(0,a.Wm)(b,{style:{height:"calc(100% - 40px)"}},{default:(0,a.w5)(()=>["view"==(0,a.SU)(S)?((0,a.wg)(),(0,a.iD)("div",{key:0,innerHTML:(0,a.SU)(r)},null,8,G)):((0,a.wg)(),(0,a.j4)(M.Z,{key:1,value:(0,a.SU)(r),style:{height:"calc(100vh - 217px)"},onSave:l[7]||(l[7]=e=>(0,a.SU)(w.nn)((0,a.SU)(t)))},null,8,["value"]))]),_:1})])]),_:1})])])])}}}),Q=(0,C.default)(F,[["__scopeId","data-v-a61e5c3c"]])}}]);