"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["9214"],{69288:function(e,t,a){a.d(t,{Ew:()=>o,JI:()=>v,L3:()=>s,Nh:()=>p,WJ:()=>u,nn:()=>f});var l=a(86244);let i={fetchOptions:{loading:"Loading... Please wait.",successMessage:!0}};async function n(e,t){try{await l.e.post("/email_template/create",{temp_name:t,add_type:2,chat_id:e,html_content:""})}catch(e){throw console.warn(e),e}}async function s(e){await c(e),await r(e)}async function o(e){try{let t=`AI_temp_${new Date().getTime()}`,a=await l.e.post("/askai/chat/create_chat",{domain:e,add_type:99,temp_name:t},i);return await n(a.chatId,t),a.chatId}catch(e){return console.warn(e),null}}async function c(e){let{modelList:t,currentModel:a,currentModelTitle:i}=e;try{t.value=await l.e.post("/askai/supplier/models"),t.value.length&&(a.value=t.value[0],i.value=t.value[0].title)}catch(e){console.warn(e)}}async function r(e){let{chatId:t,chatInfo:a,currentModel:i,modelList:n,currentModelTitle:s,chatRecord:o}=e;try{if(a.value=await l.e.post("/askai/chat/info",{chatId:t.value}),a.value.modelId&&n.value.length){let e=n.value.find(e=>e.modelId==a.value.modelId);e&&(i.value=e,s.value=e.title)}for(let e=0;e<a.value.messages.length;e++)"user"==a.value.messages[e].role&&o.value.set(`${a.value.messages[e].content}_+_${o.value.size}`,d(a.value.messages[e+1].content))}catch(e){console.warn(e)}}async function u(e){let{answerContent:t,generateShow:a,chatId:i,currentModel:n,questionContent:s,chatRecord:o,currentChatRecordKey:c}=e,r=`${s.value}_+_${o.value.size}`;o.value.set(r,[]),c.value=r;let u=[],v="",p=0;try{a.value=!0,await l.e.post("/askai/chat/chat",{chatId:i.value,supplierName:n.value.supplierName,modelId:n.value.modelId,content:s.value,is_text:"false"},{fetchOptions:{cancelResInterceptor:!0},responseType:"text",onDownloadProgress:e=>{a.value=!1;try{let a=e.event.target.responseText,l=a.slice(p);p=a.length;var t=function(e){let t=e.split("\n"),a=[];for(let e of t){let t=e.trim();if(t.startsWith("data:")){let e=t.slice(5).trim();e&&a.push(e)}}return a}(l);for(let e=0;e<t.length;e++)t[e]&&(v+=JSON.parse(t[e]).content);o.value.set(r,d(v))}catch(e){console.warn(e)}}})}catch(e){console.warn(e)}finally{a.value=!1,v="",p=0}}function d(e){let t=/```[\s\S]*?(?:```|$)/g,a=e.match(t)||[],l=e.split(t),i=[],n=Math.max(l.length,a.length);for(let e=0;e<n;e++)e<l.length&&""!==l[e].trim()&&i.push(l[e]),e<a.length&&i.push(a[e]);return i}function v(e){return e.replace(/```html/g,"").replace(/```$/gm,"")}async function p(e){let{chatId:t,previewCode:a}=e;try{a.value=await l.e.post("/askai/chat/get_html",{chatId:t.value})}catch(e){console.warn(e)}}async function f(e){let{previewCode:t,chatId:a}=e;try{await l.e.post("/askai/chat/modify_html",{chatId:a.value,content:t.value},i)}catch(e){console.warn(e)}}},66560:function(e,t,a){a.d(t,{Z:()=>o});var l=a(20993),i=a(25595),n=a(53217);let s=(0,i.aZ)({__name:"index",props:(0,i.Vf)({language:{type:String,default:"html"},theme:{type:String,default:"vs-dark"},options:{type:Object,default:()=>({})}},{value:{default:""},valueModifiers:{}}),emits:(0,i.Vf)(["save"],["update:value"]),setup(e,t){let{expose:a,emit:s}=t,o=(0,i.tT)(e,"value"),c=(0,i.iH)(null),r=null,u=(0,i.iH)(!1);n.Z.config({paths:{vs:`${location.origin}/static/plugin/monaco`}});let d=async()=>{if(c.value&&!r)try{u.value=!0;let t=await n.Z.init();(r=t.editor.create(c.value,{value:o.value,language:e.language,theme:e.theme,minimap:{enabled:!1},automaticLayout:!0,scrollBeyondLastLine:!1,fontSize:14,tabSize:2,wordWrap:"on",...e.options})).onDidChangeModelContent(()=>{o.value=(null==r?void 0:r.getValue())||""}),r.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyS,function(){s("save")})}finally{u.value=!1}},v=()=>{r&&(r.dispose(),r=null)};return(0,i.YP)(()=>o.value,e=>{r&&e!==r.getValue()&&r.setValue(e)}),(0,i.bv)(()=>{d()}),(0,i.Jd)(()=>{v()}),a({getEditor:()=>r}),(e,t)=>{let a=l.Z;return(0,i.wg)(),(0,i.j4)(a,{class:"h-full",show:(0,i.SU)(u)},{default:(0,i.w5)(()=>[(0,i._)("div",{ref_key:"containerRef",ref:c,class:"monaco-editor-container"},null,512)]),_:1},8,["show"])}}}),o=(0,a(83744).default)(s,[["__scopeId","data-v-72ffe419"]])},19810:function(e,t,a){a.r(t),a.d(t,{default:()=>N});var l=a(7308),i=a(99833),n=a(85068),s=a(77596),o=a(64657),c=a(46126),r=a(25595),u=a(69288),d=a(29121),v=a(82183),p=a(267);let f={key:0,class:"code-area"},h={class:"code-tool"},m={class:"tools"},_=["innerHTML"],g=["innerHTML"],y=(0,r.aZ)({__name:"MarkdownRender",props:{content:{},chatRecordKey:{}},emits:["codeRender"],setup(e,t){let{emit:a}=t,{copy:l,copied:i}=(0,p.VPI)(),{currentChatRecordKey:n,previewCode:s}=(0,r.f3)("modelStore"),o=(0,r.iH)(),c=(0,r.iH)(""),y=(0,r.iH)(""),w=(0,d.Z)({html:!0,linkify:!0,typographer:!0,langPrefix:"language-",highlight:function(e,t){if(c.value=t,t&&v.Z.getLanguage(t))try{return v.Z.highlight(t,e).value}catch(e){console.warn(e)}return w.utils.escapeHtml(e)}});function k(){n.value=e.chatRecordKey,(0,r.Y3)(()=>s.value=(0,u.JI)(e.content))}function x(){l(e.content)}return y.value=w.render(e.content),(0,r.YP)(()=>e.content,t=>{y.value=w.render(t),c.value&&a("codeRender",{code:e.content,key:e.chatRecordKey})}),(e,t)=>((0,r.wg)(),(0,r.iD)("div",null,[(0,r.SU)(c)?((0,r.wg)(),(0,r.iD)("div",f,[(0,r._)("div",h,[(0,r._)("span",null,(0,r.zw)((0,r.SU)(c)),1),(0,r._)("div",m,[(0,r._)("div",{class:"tool-item",onClick:x},[t[0]||(t[0]=(0,r._)("i",{class:"i-material-symbols:chrome-restore-rounded text-5"},null,-1)),(0,r._)("span",null,(0,r.zw)((0,r.SU)(i)?"Copied":"Copy"),1)]),(0,r._)("div",{class:"tool-item",onClick:k},t[1]||(t[1]=[(0,r._)("i",{class:"i-mingcute:eye-2-fill text-5"},null,-1),(0,r._)("span",null,"View",-1)]))])]),(0,r._)("div",{innerHTML:(0,r.SU)(y)},null,8,_)])):((0,r.wg)(),(0,r.iD)("div",{key:1,ref_key:"codeRef",ref:o,innerHTML:(0,r.SU)(y)},null,8,g))]))}});var w=a(83744);let k=(0,w.default)(y,[["__scopeId","data-v-134a9c48"]]);var x=a(66560),S=a(29938);let H={class:"wrapper"},I={class:"ai-container"},U={class:"chat-area"},C={class:"model-select"},b={class:"flex justify-start items-center gap-15px"},W={ref:"answerRef",class:"answer"},Z={class:"ask-content"},R={class:"text"},M={class:"answer-content"},T={class:"text"},L=["onClick"],D={class:"question"},J={class:"send-btn"},z={class:"view-area"},K={style:{height:"calc(100vh - 177px)"}},P={class:"h-10 flex justify-start items-center gap-2.5"},V={key:0},$=["innerHTML"],j=(0,r.aZ)({__name:"index",setup(e){let t=function(){let e=(0,r.iH)(""),t=(0,r.iH)(""),a=(0,r.iH)(""),l=(0,r.iH)({chatId:"",create_time:0,files:[],messages:[],modelId:"",prompt:"",supplierName:"",title:"",update_time:0}),i=(0,r.iH)(""),n=(0,r.iH)([]),s=(0,r.iH)({modelId:"",supplierName:"",capability:[],title:"",status:!1,max_tokens:0}),o=(0,r.iH)(""),c=(0,r.iH)([]),u=(0,r.iH)("");return{sourceDomain:e,chatId:t,questionContent:a,chatInfo:l,currentChatRecordKey:i,modelList:n,currentModel:s,currentModelTitle:o,answerContent:c,previewCode:u,generateShow:(0,r.iH)(!1),chatRecord:(0,r.iH)(new Map)}}();(0,r.JJ)("modelStore",t);let{chatId:a,modelList:d,currentModelTitle:v,previewCode:p,questionContent:f,chatRecord:h,currentChatRecordKey:m,currentModel:_}=t,g=(0,S.yj)(),y=(0,r.iH)(),w=(0,r.iH)(),j=(0,r.iH)("view");function N(e,t){_.value=t}function q(e){e.key==m.value&&(console.log(e.key,m.value),p.value=(0,u.JI)(e.code))}return a.value=g.params.chatId,(0,u.Nh)(t),(0,u.L3)(t),(0,r.bv)(()=>{!function e(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=t||null,i=a;if(!(i>=6)){if(l&&(clearTimeout(t),l=null),w.value.offsetHeight){y.value.scrollTo({left:0,top:w.value.offsetHeight}),i++;return}i++,l=setTimeout(()=>{e(l,i)},100)}}()}),(e,a)=>{let m=c.Z,_=o.ZP,g=s.Z,S=n.Z,Y=i.ZP,E=l.Z;return(0,r.wg)(),(0,r.iD)("div",H,[a[14]||(a[14]=(0,r.uE)('<div class="page-tit" data-v-513a9507><div class="back-tool" data-v-513a9507><i class="i-ci:arrow-left-lg text-4" data-v-513a9507></i><div class="back-btn" data-v-513a9507>back</div></div><span class="tit-content" data-v-513a9507> AI Template </span></div>',1)),(0,r._)("div",I,[(0,r._)("div",U,[(0,r._)("div",C,[(0,r.Wm)(_,null,{default:(0,r.w5)(()=>[(0,r._)("div",b,[(0,r.Wm)(m,{class:"flex-1",options:(0,r.SU)(d),"label-field":"title","value-field":"title",value:(0,r.SU)(v),"onUpdate:value":[a[0]||(a[0]=e=>(0,r.dq)(v)?v.value=e:null),N]},null,8,["options","value"])])]),_:1})]),(0,r._)("div",W,[(0,r.Wm)(_,{class:"h-100%"},{default:(0,r.w5)(()=>[(0,r.Wm)(g,{style:{height:"calc(100vh - 522px)"},ref_key:"chatScrollRef",ref:y},{default:(0,r.w5)(()=>[(0,r._)("div",{ref_key:"scrollWrapperRef",ref:w},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(h),e=>((0,r.wg)(),(0,r.iD)("div",{key:e[0],class:"answer-container"},[(0,r._)("div",Z,[a[6]||(a[6]=(0,r._)("div",{class:"pic"},[(0,r._)("i",{class:"i-material-symbols:account-circle text-6 text-[var(--color-primary-hover-1)]"})],-1)),(0,r._)("div",R,(0,r.zw)(e[0].split("_+_")[0]),1)]),(0,r._)("div",M,[a[8]||(a[8]=(0,r._)("div",{class:"pic"},[(0,r._)("span",{class:"text-4 text-[var(--color-primary-hover-1)]"},"BillionMail")],-1)),(0,r._)("div",T,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e[1],(t,a)=>((0,r.wg)(),(0,r.j4)(k,{onCodeRender:q,content:t,key:a,"chat-record-key":e[0],class:"mb-4"},null,8,["content","chat-record-key"]))),128))]),(0,r._)("div",{class:"answer-tool",onClick:a=>{f.value=e[0].toString().split("_+_")[0],(0,u.WJ)(t)}},a[7]||(a[7]=[(0,r._)("div",{class:"tool-item"},[(0,r._)("i",{class:"i-ri:refresh-line text-5"}),(0,r._)("span",null,"Regenerate")],-1),(0,r._)("div",{class:"tool-item"},[(0,r._)("i",{class:"i-ri:information-2-fill text-5"}),(0,r._)("span",null,"Info")],-1)]),8,L)])]))),128))],512)]),_:1},512)]),_:1})],512),(0,r._)("div",D,[(0,r.Wm)(_,{style:{height:"100%"}},{default:(0,r.w5)(()=>[(0,r.Wm)(S,{type:"textarea",class:"question-input",value:(0,r.SU)(f),"onUpdate:value":a[1]||(a[1]=e=>(0,r.dq)(f)?f.value=e:null)},null,8,["value"]),(0,r._)("div",J,[a[9]||(a[9]=(0,r._)("i",{class:"i-icon-park-twotone:new-picture text-8 text-[var(--color-primary-1)] hover-text-[var(--color-primary-hover-1)]"},null,-1)),(0,r._)("i",{class:"i-icon-park-twotone:arrow-circle-up text-8 text-[var(--color-primary-1)] hover-text-[var(--color-primary-hover-1)]",onClick:a[2]||(a[2]=e=>(0,r.SU)(u.WJ)((0,r.SU)(t)))})])]),_:1})])]),(0,r._)("div",z,[(0,r.Wm)(_,{style:{height:"100%"}},{default:(0,r.w5)(()=>[(0,r._)("div",K,[(0,r._)("div",P,[(0,r.Wm)(E,{size:"small"},{default:(0,r.w5)(()=>[(0,r.Wm)(Y,{type:"view"==(0,r.SU)(j)?"primary":"default",onClick:a[3]||(a[3]=e=>j.value="view")},{icon:(0,r.w5)(()=>a[10]||(a[10]=[(0,r._)("i",{class:"i-mingcute:eye-2-fill text-5"},null,-1)])),default:(0,r.w5)(()=>[a[11]||(a[11]=(0,r.Uk)(" View "))]),_:1,__:[11]},8,["type"]),(0,r.Wm)(Y,{type:"edit"==(0,r.SU)(j)?"primary":"default",onClick:a[4]||(a[4]=e=>j.value="edit")},{icon:(0,r.w5)(()=>a[12]||(a[12]=[(0,r._)("i",{class:"i-tdesign:code text-5"},null,-1)])),default:(0,r.w5)(()=>[a[13]||(a[13]=(0,r.Uk)(" Edit "))]),_:1,__:[13]},8,["type"])]),_:1}),"edit"==(0,r.SU)(j)?((0,r.wg)(),(0,r.iD)("span",V,"[Ctrl + s] to save your change")):(0,r.kq)("",!0)]),(0,r.Wm)(g,{style:{height:"calc(100% - 40px)"}},{default:(0,r.w5)(()=>["view"==(0,r.SU)(j)?((0,r.wg)(),(0,r.iD)("div",{key:0,innerHTML:(0,r.SU)(p)},null,8,$)):((0,r.wg)(),(0,r.j4)(x.Z,{key:1,value:(0,r.SU)(p),style:{height:"calc(100vh - 217px)"},onSave:a[5]||(a[5]=e=>(0,r.SU)(u.nn)((0,r.SU)(t)))},null,8,["value"]))]),_:1})])]),_:1})])])])}}}),N=(0,w.default)(j,[["__scopeId","data-v-513a9507"]])}}]);